"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("react"),t=require("@shopify/polaris"),S={Annual:"ANNUAL",Every30Days:"EVERY_30_DAYS"},ae={Public:"public",CustomerTag:"customerTag",ShopifyPlan:"shopifyPlan",Customer:"customer",Hidden:"hidden"},E={AmountPerInterval:"{{ amount }} per {{ interval }}",Back:"Back",Cancel:"Cancel",CancelConfirmation:"Are you sure you want to cancel your subscription?",CancelPlan:"Cancel plan",ChangePlan:"Change plan",CurrentPlan:"Current plan",CustomPlans:"Custom plans",CustomPlansDescription:"Plans tailored to your specific needs",DiscountAmount:"{{ amount }} discount",DiscountAmountExpired:"{{ amount }} discount expired",FreeTrialLength:"{{ trialDays }}-day free trial",Features:"Features",Month:"month",MonthShort:"mo",Monthly:"Monthly",NextBillingDate:"Next billing date",NotSubscribed:"You're not subscribed to a plan yet.",Year:"year",YearShort:"yr",Yearly:"Yearly",MostPopular:"Most popular",Per:"/",Plans:"Plans",Price:"Price",SelectPlan:"Select plan",SubscribeSuccessTitle:"Subscription successful",SubscribeSuccessBody:"Thanks for subscribing to our app!",Subscription:"Subscription",SubscriptionCancelled:"Subscription cancelled",UsageCharges:"Usage charges"},Ee=e.createContext(),fe=()=>{const n=e.useContext(Ee);if(n===void 0)throw new Error("useMantle must be used within a MantleProvider");return n},ve=(n="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:n,notation:"standard"}),U=(n,i="USD",m=!0)=>{let d=ve(i).format(n);return m&&(d=d.replace(/\.00$/,"")),d},Se=(n=S.Every30Days)=>{switch(n){case S.Annual:return"year";case S.Every30Days:default:return"month"}},be=(n=S.Every30Days)=>{switch(n){case S.Annual:return"yr";case S.Every30Days:default:return"mo"}},Q=({interval:n=S.Every30Days,useShortFormPlanIntervals:i=!0})=>i?be(n):Se(n),oe=({plan:n,customFieldKey:i="recommended"})=>{var m;return!!((m=n.customFields)!=null&&m[i])},se=({plan:n,customFieldKey:i="buttonLabel"})=>{var m;return((m=n.customFields)==null?void 0:m[i])||E.SelectPlan},pe=({plan:n})=>{var i;return((i=n.discounts)==null?void 0:i.length)>0?n.discounts.reduce((m,d)=>m.discountedAmount<d.discountedAmount?m:d):void 0},ke=(n=4)=>n%4===0?{xs:6,sm:6,md:2,lg:3,xl:3}:n%3===0?{xs:6,sm:6,md:2,lg:4,xl:4}:n%2===0?{xs:6,sm:6,md:3,lg:6,xl:6}:n===1?{xs:6,sm:6,md:6,lg:12,xl:12}:{xs:6,sm:6,md:2,lg:4,xl:4},xe=(n=4)=>n%4===0?4:n%3===0?3:n%2===0?2:n===1?1:4;var Z=function(i){return e.createElement("svg",Object.assign({viewBox:"0 0 20 20"},i),e.createElement("path",{fillRule:"evenodd",d:"M15.78 5.97a.75.75 0 0 1 0 1.06l-6.5 6.5a.75.75 0 0 1-1.06 0l-3.25-3.25a.75.75 0 1 1 1.06-1.06l2.72 2.72 5.97-5.97a.75.75 0 0 1 1.06 0Z"}))};Z.displayName="CheckIcon";var ie=function(i){return e.createElement("svg",Object.assign({viewBox:"0 0 20 20"},i),e.createElement("path",{d:"M10.75 6.75a.75.75 0 0 0-1.5 0v2.5h-2.5a.75.75 0 0 0 0 1.5h2.5v2.5a.75.75 0 0 0 1.5 0v-2.5h2.5a.75.75 0 0 0 0-1.5h-2.5v-2.5Z"}))};ie.displayName="PlusIcon";const Ce=({plan:n})=>e.createElement(t.BlockStack,{gap:"100"},e.createElement(t.Text,{variant:"headingMd",alignment:"center"},n.name),n.description&&e.createElement(t.Text,{variant:"bodyLg",tone:"subdued",alignment:"center"},n.description)),$e=({plan:n,discount:i,useShortFormPlanIntervals:m=!0})=>e.createElement(t.BlockStack,{gap:"100"},!!i&&e.createElement(t.InlineStack,{align:"center",blockAlign:"center",gap:"200"},e.createElement(t.Text,{variant:"heading3xl"},U(i.discountedAmount,n.currency,!0)),e.createElement(t.Text,{variant:"heading3xl",tone:"subdued",fontWeight:"medium",textDecorationLine:"line-through"},U(n.amount,n.currency,!0)),e.createElement(t.Text,{variant:"bodyLg",tone:"subdued"},E.Per," ",Q({interval:n.interval,useShortFormPlanIntervals:m}))),!i&&e.createElement(t.InlineStack,{align:"center",blockAlign:"center",gap:"200"},e.createElement(t.Text,{alignment:"center",variant:"heading3xl"},U(n.amount,n.currency,!0)),e.createElement(t.Text,{alignment:"center",variant:"bodyLg",tone:"subdued"},E.Per," ",Q({interval:n.interval,useShortFormPlanIntervals:m}))),n.usageCharges.length>0&&e.createElement(t.BlockStack,null,n.usageCharges.map((d,g)=>e.createElement(t.InlineStack,{key:`plan-usageCharge-${g}`,align:"center",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:ie,tone:"positive"})),e.createElement(t.Text,{variant:"bodyLg"},d.terms))))),Be=({plan:n,trialDaysAsFeature:i=!1})=>e.createElement(t.BlockStack,{gap:"300"},i&&n.trialDays&&n.trialDays>0?e.createElement(t.InlineStack,{align:"center",blockAlign:"center",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:Z,tone:"positive"})),e.createElement(t.Text,{tone:"subdued"},E.FreeTrialLength.replace("{{ trialDays }}",n.trialDays))):null,n.featuresOrder.map((m,d)=>{const g=n.features[m];if(g.type!=="boolean"||g.value===!0)return e.createElement(t.InlineStack,{key:`plan-feature-${d}`,align:"center",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:Z,tone:"positive"})),g.type==="boolean"?e.createElement(t.Text,{tone:"subdued"},g.name):e.createElement(t.Text,{tone:"subdued"},g.value," ",g.name))})),Pe=({plan:n,discount:i,buttonLabel:m,onSelectPlan:d,useShortFormPlanIntervals:g=!0,trialDaysAsFeature:u=!1,expanded:f=!1,isActivePlan:P=!1,isRecommendedPlan:$=!1,isCustomPlan:p=!1,showRecommendedPlanBadge:w=!0})=>{const[x,v]=e.useState(!1),A=async({plan:D,discount:T})=>{d?(v(!0),await d({plan:D,discount:T})!==!0&&v(!1)):console.log("No onSelectPlan callback provided")};return e.createElement(t.Box,{position:"relative",minHeight:"100%"},e.createElement(t.Box,{paddingBlock:f||$?void 0:"800",minHeight:"100%"},e.createElement(t.Box,{background:$||p?"bg-surface":"bg-surface-secondary",borderStyle:"solid",borderColor:"border",borderWidth:"025",paddingBlock:f||$?"1600":"800",paddingInline:"400",borderRadius:"200",minHeight:"calc(100% - calc(var(--p-space-800) * 2))"},e.createElement(t.BlockStack,{gap:"800"},e.createElement(t.BlockStack,{gap:"400"},e.createElement(Ce,{plan:n}),e.createElement($e,{plan:n,discount:i,useShortFormPlanIntervals:g})),e.createElement(t.Button,{size:"large",variant:$?"primary":"secondary",onClick:async()=>{await A({plan:n,discount:i})},disabled:P,loading:x},m||E.SelectPlan),e.createElement(Be,{plan:n,trialDaysAsFeature:u}),$&&w&&e.createElement(t.InlineStack,{align:"center",gap:"100"},e.createElement(t.Badge,{tone:"success"},E.MostPopular))))))},G={Highlighted:"highlighted",Horizontal:"horizontal",Vertical:"vertical"},re=({plans:n,customer:i,onSelectPlan:m,planInterval:d,cardType:g=G.Horizontal,trialDaysAsFeature:u=!0,useShortFormPlanIntervals:f=!0,keyForRecommended:P="recommended",keyForCustomButtonLabel:$="buttonLabel",showRecommendedPlanBadge:p=!0,applyDiscount:w=!0})=>{var C;const x=(C=i==null?void 0:i.subscription)!=null&&C.active?i.subscription:void 0,v=x==null?void 0:x.plan,A=d?n.filter(k=>k.interval===d):n,D=g===G.Vertical?1:xe(A.length),T=ke(D);return e.createElement(t.Grid,{columns:D},A.map(k=>{const z=w?pe({plan:k}):void 0;return e.createElement(t.Grid.Cell,{columnSpan:T,key:k.id},g===G.Highlighted&&e.createElement(Pe,{key:`HighlightedPlanCard-${k.id}`,plan:k,discount:z,onSelectPlan:m,isActivePlan:(v==null?void 0:v.id)===k.id,trialDaysAsFeature:u,useShortFormPlanIntervals:f,isCustomPlan:k.availability!==ae.Public,isRecommendedPlan:oe({plan:k,customFieldKey:P}),buttonLabel:se({plan:k,customFieldKey:$}),showRecommendedPlanBadge:p}),g===G.Horizontal&&e.createElement(he,{key:`HorizontalPlanCard-${k.id}`,plan:k,discount:z,onSelectPlan:m,isActivePlan:(v==null?void 0:v.id)===k.id,trialDaysAsFeature:u,useShortFormPlanIntervals:f,isRecommendedPlan:oe({plan:k,customFieldKey:P}),buttonLabel:se({plan:k,customFieldKey:$}),showRecommendedPlanBadge:p}))}))},we=({customer:n,plans:i,onSubscribe:m,backUrl:d="",showRecommendedBadge:g=!0,customFieldCta:u,customFieldPlanRecommended:f="Recommended",showPlanIntervalToggle:P=!0,showTrialDaysAsFeature:$=!0,useShortFormPlanIntervals:p,pageWidth:w="default",showCustomPlans:x=!0})=>{const v=n==null?void 0:n.subscription,A=new URLSearchParams(window.location.search),D=i.some(b=>b.interval===S.Annual)&&i.some(b=>b.interval===S.Every30Days),T=i.find(b=>b.id===(v==null?void 0:v.plan.id)),[C,k]=e.useState(T?T.interval:D?S.Annual:S.Every30Days),z=i.filter(b=>b.availability===ae.Public),M=x?i.filter(b=>b.availability!==ae.Public):[],[_,N]=e.useState(A.get("subscribed")==="true");return e.createElement(t.Page,{title:E.Plans,backAction:d?{content:E.Back,url:d}:void 0,secondaryActions:P&&D?e.createElement(t.ButtonGroup,{variant:"segmented"},e.createElement(t.Button,{pressed:C===S.Every30Days,onClick:()=>k(S.Every30Days)},E.Monthly),e.createElement(t.Button,{pressed:C===S.Annual,onClick:()=>k(S.Annual)},E.Yearly)):void 0,fullWidth:w==="full",narrowWidth:w==="narrow"},e.createElement(t.Layout,null,e.createElement(t.Layout.Section,null,e.createElement(t.BlockStack,{gap:"1000"},_&&e.createElement(t.Banner,{tone:"success",title:E.SubscribeSuccessTitle,onDismiss:()=>{N(!1),window.history.replaceState({},document.title,window.location.pathname)}},E.SubscribeSuccessBody),e.createElement(re,{plans:z,onSelectPlan:m,planInterval:C,cardType:G.Horizontal,keyForRecommended:f,keyForCustomButtonLabel:u,trialDaysAsFeature:$,useShortFormPlanIntervals:p,showRecommendedPlanBadge:g}),(M==null?void 0:M.length)>0&&e.createElement(t.Divider,{borderColor:"border"}),(M==null?void 0:M.length)>0&&e.createElement(t.BlockStack,{gap:"300"},e.createElement(t.Box,{paddingInline:{xs:400,sm:0}},e.createElement(t.Text,{variant:"headingMd"},E.CustomPlans)),e.createElement(re,{plans:M,onSelectPlan:m,planInterval:C,cardType:G.Horizontal,keyForRecommended:f,keyForCustomButtonLabel:u,trialDaysAsFeature:$,useShortFormPlanIntervals:p,showRecommendedPlanBadge:g}))))))},de=({plan:n,isRecommendedPlan:i=!1})=>e.createElement(t.BlockStack,null,e.createElement(t.InlineStack,{align:"space-between",gap:"100"},e.createElement(t.Text,{variant:"bodyLg"},n.name),i&&e.createElement(t.Badge,{tone:"success"},E.MostPopular)),n.description&&e.createElement(t.Text,{tone:"subdued"},n.description)),me=({plan:n,discount:i,useShortFormPlanIntervals:m=!0})=>e.createElement(t.BlockStack,{gap:"100"},!!i&&e.createElement(t.InlineStack,{blockAlign:"center",gap:"200"},e.createElement(t.Text,{variant:"headingXl"},U(i.discountedAmount,n.currency)),e.createElement(t.Text,{variant:"headingXl",tone:"subdued",fontWeight:"medium",textDecorationLine:"line-through"},n.amount),e.createElement(t.Text,{variant:"bodyLg",tone:"subdued"},E.Per," ",Q({interval:n.interval,useShortFormPlanIntervals:m}))),!i&&e.createElement(t.InlineStack,{blockAlign:"center",gap:"200"},e.createElement(t.Text,{alignment:"center",variant:"headingXl"},U(n.amount,n.currency)),e.createElement(t.Text,{alignment:"center",variant:"bodyLg",tone:"subdued"},E.Per," ",Q({interval:n.interval,useShortFormPlanIntervals:m}))),n.usageCharges&&n.usageCharges.length>0&&e.createElement(t.BlockStack,null,n.usageCharges.map((d,g)=>e.createElement(t.InlineStack,{key:`plan-usageCharge-${g}`,align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:ie,tone:"positive"})),e.createElement(t.Text,{variant:"bodyLg"},d.terms))))),ge=({plan:n,trialDaysAsFeature:i=!1})=>e.createElement(t.BlockStack,{gap:"100"},i&&n.trialDays&&n.trialDays>0?e.createElement(t.InlineStack,{align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:Z,tone:"positive"})),e.createElement(t.Text,{tone:"subdued"},E.FreeTrialLength.replace("{{ trialDays }}",n.trialDays))):null,n.featuresOrder.map((m,d)=>{const g=n.features[m];if(g.type!=="boolean"||g.value===!0)return e.createElement(t.InlineStack,{key:`plan-feature-${d}`,align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:Z,tone:"positive"})),g.type==="boolean"?e.createElement(t.Text,{tone:"subdued"},g.name):e.createElement(t.Text,{tone:"subdued"},g.value," ",g.name))})),he=({plan:n,discount:i,buttonLabel:m,onSelectPlan:d,useShortFormPlanIntervals:g=!0,trialDaysAsFeature:u=!1,isRecommendedPlan:f=!1,isActivePlan:P=!1})=>{const[$,p]=e.useState(!1),w=async({plan:x,discount:v})=>{d?(p(!0),await d({plan:x,discount:v})!==!0&&p(!1)):console.log("No onSelectPlan callback provided")};return e.createElement(t.Card,null,e.createElement(t.BlockStack,{gap:"400"},e.createElement(de,{plan:n,isRecommendedPlan:f}),e.createElement(me,{plan:n,discount:i,useShortFormPlanIntervals:g}),e.createElement(t.Button,{size:"large",variant:f?"primary":"secondary",onClick:async()=>{await w({plan:n,discount:i})},disabled:P,loading:$},P?E.CurrentPlan:m||E.SelectPlan),e.createElement(ge,{plan:n,trialDaysAsFeature:u})))},De=({customer:n,plans:i,onSubscribe:m,backUrl:d="",showRecommendedBadge:g=!0,customFieldCta:u=null,customFieldPlanRecommended:f="Recommended",showPlanIntervalToggle:P=!0,showTrialDaysAsFeature:$=!0,useShortFormPlanIntervals:p=!0,pageWidth:w="default",showCustomPlans:x=!0})=>{const v=n==null?void 0:n.subscription,A=new URLSearchParams(window.location.search),D=i.some(b=>b.interval===S.Annual)&&i.some(b=>b.interval===S.Every30Days),T=i.find(b=>b.id===(v==null?void 0:v.plan.id)),[C,k]=e.useState(T?T.interval:D?S.Annual:S.Every30Days),z=i.filter(b=>b.availability===ae.Public),M=x?i.filter(b=>b.availability!==ae.Public):[],[_,N]=e.useState(A.get("subscribed")==="true");return e.createElement(t.Page,{title:E.Plans,backAction:d&&d!==""?{content:E.Back,url:d}:void 0,secondaryActions:P&&D?e.createElement(t.ButtonGroup,{variant:"segmented"},e.createElement(t.Button,{pressed:C===S.Every30Days,onClick:()=>k(S.Every30Days)},E.Monthly),e.createElement(t.Button,{pressed:C===S.Annual,onClick:()=>k(S.Annual)},E.Yearly)):void 0,fullWidth:w==="full",narrowWidth:w==="narrow"},e.createElement(t.Box,{paddingBlockEnd:"800"},e.createElement(t.Layout,null,e.createElement(t.Layout.Section,null,e.createElement(t.BlockStack,{gap:"1000"},_&&e.createElement(t.Banner,{tone:"success",title:E.SubscribeSuccessTitle,onDismiss:()=>{N(!1),window.history.replaceState({},document.title,window.location.pathname)}},E.SubscribeSuccessBody),e.createElement(re,{plans:z,onSelectPlan:m,planInterval:C,cardType:G.Highlighted,keyForRecommended:f,keyForCustomButtonLabel:u,trialDaysAsFeature:$,useShortFormPlanIntervals:p,showRecommendedPlanBadge:g}),(M==null?void 0:M.length)>0&&e.createElement(t.Divider,{borderColor:"border"}),(M==null?void 0:M.length)>0&&e.createElement(t.BlockStack,{gap:"300"},e.createElement(t.Box,{paddingInline:{xs:400,sm:0}},e.createElement(t.Text,{variant:"headingMd"},E.CustomPlans)),e.createElement(re,{plans:M,onSelectPlan:m,planInterval:C,cardType:G.Highlighted,keyForRecommended:f,keyForCustomButtonLabel:u,trialDaysAsFeature:$,useShortFormPlanIntervals:p,showRecommendedPlanBadge:g})))))))},Te=({customer:n,plans:i,onSubscribe:m,backUrl:d="",showRecommendedBadge:g=!0,customFieldCta:u=null,customFieldPlanRecommended:f="Recommended",showPlanIntervalToggle:P=!1,showTrialDaysAsFeature:$=!0,useShortFormPlanIntervals:p=!0,pageWidth:w="default",showCustomPlans:x=!0})=>{const v=n==null?void 0:n.subscription,A=new URLSearchParams(window.location.search),D=i.some(a=>a.interval===S.Annual)&&i.some(a=>a.interval===S.Every30Days),T=i.find(a=>a.id===(v==null?void 0:v.plan.id)),[C,k]=e.useState(T?T.interval:D?S.Annual:S.Every30Days),z=i.filter(a=>a.availability!=="customerTag"&&a.availability!=="customer"),M=P&&D?z.filter(a=>a.interval===C):z,_=x?i.filter(a=>a.availability==="customerTag"||a.availability==="customer"):[],[N,b]=e.useState(A.get("subscribed")==="true"),ee=({plan:a,discount:O})=>e.createElement(t.BlockStack,null,e.createElement(t.Text,{variant:"bodyLg"},a.name),a.description&&e.createElement(t.Text,{tone:"subdued"},a.description)),J=({plan:a,discount:O})=>e.createElement(t.BlockStack,{gap:"200"},e.createElement(t.Text,{fontWeight:"medium"},E.Features),e.createElement(t.BlockStack,{gap:"100"},$&&a.trialDays!==0&&e.createElement(t.InlineStack,{align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:Z,tone:"positive"})),e.createElement(t.Text,{tone:"subdued"},E.FreeTrialLength.replace("{{ trialDays }}",a.trialDays))),a.featuresOrder.map((H,o)=>{const l=a.features[H];if(l.type!=="boolean"||l.value===!0)return e.createElement(t.InlineStack,{key:`plan-feature-${o}`,align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:Z,tone:"positive"})),l.type==="boolean"?e.createElement(t.Text,{tone:"subdued"},l.name):e.createElement(t.Text,{tone:"subdued"},l.value," ",l.name))}))),V=({plan:a,discount:O})=>e.createElement(t.BlockStack,{gap:"100"},O?e.createElement(t.InlineStack,{blockAlign:"center",gap:"200"},e.createElement(t.Text,{variant:"headingXl"},U(O.discountedAmount,a.currency)),e.createElement(t.Text,{variant:"headingXl",tone:"subdued",fontWeight:"medium",textDecorationLine:"line-through"},a.amount),e.createElement(t.Text,{variant:"bodyLg",tone:"subdued"},E.Per," ",Q({interval:a.interval,useShortFormPlanIntervals:p}))):e.createElement(t.InlineStack,{blockAlign:"center",gap:"200"},e.createElement(t.Text,{alignment:"center",variant:"headingXl"},U(a.amount,a.currency)),e.createElement(t.Text,{alignment:"center",variant:"bodyLg",tone:"subdued"},E.Per," ",Q({interval:a.interval,useShortFormPlanIntervals:p}))),a.usageCharges.length>0&&e.createElement(t.BlockStack,null,a.usageCharges.map((H,o)=>e.createElement(t.InlineStack,{key:`plan-usageCharge-${o}`,align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:ie,tone:"positive"})),e.createElement(t.Text,{variant:"bodyLg"},H.terms))))),I=({plan:a,discount:O})=>{const H=u&&a.customFields[u],o=a.customFields&&a.customFields[f];return e.createElement(t.InlineStack,{blockAlign:"center",gap:"400"},e.createElement(t.Button,{size:"large",variant:o?"primary":"secondary",onClick:()=>m({planId:a.id,discountId:O==null?void 0:O.id}),disabled:(T==null?void 0:T.id)===a.id},(T==null?void 0:T.id)===a.id?E.CurrentPlan:H?a.customFields[u]:E.SelectPlan),o&&g&&e.createElement(t.Box,null,e.createElement(t.Badge,{tone:"success"},E.MostPopular)))};return e.createElement(t.Page,{title:E.Plans,backAction:d!==""?{content:E.Back,url:d}:void 0,secondaryActions:P&&D?e.createElement(t.ButtonGroup,{variant:"segmented"},e.createElement(t.Button,{pressed:C===S.Every30Days,onClick:()=>k(S.Every30Days)},E.Monthly),e.createElement(t.Button,{pressed:C===S.Annual,onClick:()=>k(S.Annual)},E.Year)):void 0,fullWidth:w==="full",narrowWidth:w==="narrow"},e.createElement(t.Layout,null,e.createElement(t.Layout.Section,null,e.createElement(t.BlockStack,{gap:"400"},N&&e.createElement(t.Banner,{tone:"success",title:E.SubscribeSuccessTitle,onDismiss:()=>{b(!1),window.history.replaceState({},document.title,window.location.pathname)}},E.SubscribeSuccessBody),M.map((a,O)=>{var o;const H=((o=a.discounts)==null?void 0:o.length)>0?a.discounts.reduce((l,r)=>l.discountedAmount<r.discountedAmount?l:r):null;return e.createElement(t.Card,{key:`plan-${O}`},e.createElement(t.Grid,null,e.createElement(t.Grid.Cell,{columnSpan:{xs:6,sm:6,md:3,lg:6,xl:12}},e.createElement(t.BlockStack,{gap:"400"},e.createElement(t.BlockStack,{gap:"200"},ee({plan:a,discount:H}),V({plan:a,discount:H})),e.createElement(t.Box,null,I({plan:a,discount:H})))),e.createElement(t.Grid.Cell,{columnSpan:{xs:6,sm:6,md:3,lg:6,xl:12}},J({plan:a,discount:H}))))}),(_==null?void 0:_.length)>0&&e.createElement(t.Divider,{borderColor:"border"}),(_==null?void 0:_.length)>0&&e.createElement(t.BlockStack,{gap:"300"},e.createElement(t.Box,{paddingInline:{xs:400,sm:0}},e.createElement(t.Text,{variant:"headingMd"},E.CustomPlans)),e.createElement(t.Grid,null,_.map((a,O)=>{var o;const H=((o=a.discounts)==null?void 0:o.length)>0?a.discounts.reduce((l,r)=>l.discountedAmount<r.discountedAmount?l:r):null;return e.createElement(t.Grid.Cell,{key:`custom-plan-${O}`,columnSpan:columnSpan()},e.createElement(t.Card,null,e.createElement(t.BlockStack,{gap:"400"},ee({plan:a,discount:H}),V({plan:a,discount:H}),I({plan:a,discount:H}),J({plan:a,discount:H}))))})))))))};var Me=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ae(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ye={exports:{}};(function(n,i){(function(m,d){n.exports=d()})(Me,function(){var m=1e3,d=6e4,g=36e5,u="millisecond",f="second",P="minute",$="hour",p="day",w="week",x="month",v="quarter",A="year",D="date",T="Invalid Date",C=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,k=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,z={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(o){var l=["th","st","nd","rd"],r=o%100;return"["+o+(l[(r-20)%10]||l[r]||l[0])+"]"}},M=function(o,l,r){var s=String(o);return!s||s.length>=l?o:""+Array(l+1-s.length).join(r)+o},_={s:M,z:function(o){var l=-o.utcOffset(),r=Math.abs(l),s=Math.floor(r/60),c=r%60;return(l<=0?"+":"-")+M(s,2,"0")+":"+M(c,2,"0")},m:function o(l,r){if(l.date()<r.date())return-o(r,l);var s=12*(r.year()-l.year())+(r.month()-l.month()),c=l.clone().add(s,x),h=r-c<0,y=l.clone().add(s+(h?-1:1),x);return+(-(s+(r-c)/(h?c-y:y-c))||0)},a:function(o){return o<0?Math.ceil(o)||0:Math.floor(o)},p:function(o){return{M:x,y:A,w,d:p,D,h:$,m:P,s:f,ms:u,Q:v}[o]||String(o||"").toLowerCase().replace(/s$/,"")},u:function(o){return o===void 0}},N="en",b={};b[N]=z;var ee="$isDayjsObject",J=function(o){return o instanceof O||!(!o||!o[ee])},V=function o(l,r,s){var c;if(!l)return N;if(typeof l=="string"){var h=l.toLowerCase();b[h]&&(c=h),r&&(b[h]=r,c=h);var y=l.split("-");if(!c&&y.length>1)return o(y[0])}else{var B=l.name;b[B]=l,c=B}return!s&&c&&(N=c),c||!s&&N},I=function(o,l){if(J(o))return o.clone();var r=typeof l=="object"?l:{};return r.date=o,r.args=arguments,new O(r)},a=_;a.l=V,a.i=J,a.w=function(o,l){return I(o,{locale:l.$L,utc:l.$u,x:l.$x,$offset:l.$offset})};var O=function(){function o(r){this.$L=V(r.locale,null,!0),this.parse(r),this.$x=this.$x||r.x||{},this[ee]=!0}var l=o.prototype;return l.parse=function(r){this.$d=function(s){var c=s.date,h=s.utc;if(c===null)return new Date(NaN);if(a.u(c))return new Date;if(c instanceof Date)return new Date(c);if(typeof c=="string"&&!/Z$/i.test(c)){var y=c.match(C);if(y){var B=y[2]-1||0,L=(y[7]||"0").substring(0,3);return h?new Date(Date.UTC(y[1],B,y[3]||1,y[4]||0,y[5]||0,y[6]||0,L)):new Date(y[1],B,y[3]||1,y[4]||0,y[5]||0,y[6]||0,L)}}return new Date(c)}(r),this.init()},l.init=function(){var r=this.$d;this.$y=r.getFullYear(),this.$M=r.getMonth(),this.$D=r.getDate(),this.$W=r.getDay(),this.$H=r.getHours(),this.$m=r.getMinutes(),this.$s=r.getSeconds(),this.$ms=r.getMilliseconds()},l.$utils=function(){return a},l.isValid=function(){return this.$d.toString()!==T},l.isSame=function(r,s){var c=I(r);return this.startOf(s)<=c&&c<=this.endOf(s)},l.isAfter=function(r,s){return I(r)<this.startOf(s)},l.isBefore=function(r,s){return this.endOf(s)<I(r)},l.$g=function(r,s,c){return a.u(r)?this[s]:this.set(c,r)},l.unix=function(){return Math.floor(this.valueOf()/1e3)},l.valueOf=function(){return this.$d.getTime()},l.startOf=function(r,s){var c=this,h=!!a.u(s)||s,y=a.p(r),B=function(X,W){var R=a.w(c.$u?Date.UTC(c.$y,W,X):new Date(c.$y,W,X),c);return h?R:R.endOf(p)},L=function(X,W){return a.w(c.toDate()[X].apply(c.toDate("s"),(h?[0,0,0,0]:[23,59,59,999]).slice(W)),c)},F=this.$W,Y=this.$M,j=this.$D,q="set"+(this.$u?"UTC":"");switch(y){case A:return h?B(1,0):B(31,11);case x:return h?B(1,Y):B(0,Y+1);case w:var K=this.$locale().weekStart||0,te=(F<K?F+7:F)-K;return B(h?j-te:j+(6-te),Y);case p:case D:return L(q+"Hours",0);case $:return L(q+"Minutes",1);case P:return L(q+"Seconds",2);case f:return L(q+"Milliseconds",3);default:return this.clone()}},l.endOf=function(r){return this.startOf(r,!1)},l.$set=function(r,s){var c,h=a.p(r),y="set"+(this.$u?"UTC":""),B=(c={},c[p]=y+"Date",c[D]=y+"Date",c[x]=y+"Month",c[A]=y+"FullYear",c[$]=y+"Hours",c[P]=y+"Minutes",c[f]=y+"Seconds",c[u]=y+"Milliseconds",c)[h],L=h===p?this.$D+(s-this.$W):s;if(h===x||h===A){var F=this.clone().set(D,1);F.$d[B](L),F.init(),this.$d=F.set(D,Math.min(this.$D,F.daysInMonth())).$d}else B&&this.$d[B](L);return this.init(),this},l.set=function(r,s){return this.clone().$set(r,s)},l.get=function(r){return this[a.p(r)]()},l.add=function(r,s){var c,h=this;r=Number(r);var y=a.p(s),B=function(Y){var j=I(h);return a.w(j.date(j.date()+Math.round(Y*r)),h)};if(y===x)return this.set(x,this.$M+r);if(y===A)return this.set(A,this.$y+r);if(y===p)return B(1);if(y===w)return B(7);var L=(c={},c[P]=d,c[$]=g,c[f]=m,c)[y]||1,F=this.$d.getTime()+r*L;return a.w(F,this)},l.subtract=function(r,s){return this.add(-1*r,s)},l.format=function(r){var s=this,c=this.$locale();if(!this.isValid())return c.invalidDate||T;var h=r||"YYYY-MM-DDTHH:mm:ssZ",y=a.z(this),B=this.$H,L=this.$m,F=this.$M,Y=c.weekdays,j=c.months,q=c.meridiem,K=function(W,R,ne,le){return W&&(W[R]||W(s,h))||ne[R].slice(0,le)},te=function(W){return a.s(B%12||12,W,"0")},X=q||function(W,R,ne){var le=W<12?"AM":"PM";return ne?le.toLowerCase():le};return h.replace(k,function(W,R){return R||function(ne){switch(ne){case"YY":return String(s.$y).slice(-2);case"YYYY":return a.s(s.$y,4,"0");case"M":return F+1;case"MM":return a.s(F+1,2,"0");case"MMM":return K(c.monthsShort,F,j,3);case"MMMM":return K(j,F);case"D":return s.$D;case"DD":return a.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return K(c.weekdaysMin,s.$W,Y,2);case"ddd":return K(c.weekdaysShort,s.$W,Y,3);case"dddd":return Y[s.$W];case"H":return String(B);case"HH":return a.s(B,2,"0");case"h":return te(1);case"hh":return te(2);case"a":return X(B,L,!0);case"A":return X(B,L,!1);case"m":return String(L);case"mm":return a.s(L,2,"0");case"s":return String(s.$s);case"ss":return a.s(s.$s,2,"0");case"SSS":return a.s(s.$ms,3,"0");case"Z":return y}return null}(W)||y.replace(":","")})},l.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},l.diff=function(r,s,c){var h,y=this,B=a.p(s),L=I(r),F=(L.utcOffset()-this.utcOffset())*d,Y=this-L,j=function(){return a.m(y,L)};switch(B){case A:h=j()/12;break;case x:h=j();break;case v:h=j()/3;break;case w:h=(Y-F)/6048e5;break;case p:h=(Y-F)/864e5;break;case $:h=Y/g;break;case P:h=Y/d;break;case f:h=Y/m;break;default:h=Y}return c?h:a.a(h)},l.daysInMonth=function(){return this.endOf(x).$D},l.$locale=function(){return b[this.$L]},l.locale=function(r,s){if(!r)return this.$L;var c=this.clone(),h=V(r,s,!0);return h&&(c.$L=h),c},l.clone=function(){return a.w(this.$d,this)},l.toDate=function(){return new Date(this.valueOf())},l.toJSON=function(){return this.isValid()?this.toISOString():null},l.toISOString=function(){return this.$d.toISOString()},l.toString=function(){return this.$d.toUTCString()},o}(),H=O.prototype;return I.prototype=H,[["$ms",u],["$s",f],["$m",P],["$H",$],["$W",p],["$M",x],["$y",A],["$D",D]].forEach(function(o){H[o[1]]=function(l){return this.$g(l,o[0],o[1])}}),I.extend=function(o,l){return o.$i||(o(l,O,I),o.$i=!0),I},I.locale=V,I.isDayjs=J,I.unix=function(o){return I(1e3*o)},I.en=b[N],I.Ls=b,I.p={},I})})(ye);var Ie=ye.exports;const ue=Ae(Ie),ce=({orientation:n="horizontal",onShowPlans:i,onCancelPlan:m,onPlanCancelled:d=()=>{},cancelSubscription:g=async()=>{},i18n:u,subscription:f,refetch:P=async()=>{}})=>{var _;const[$,p]=e.useState(!1),[w,x]=e.useState(!1);if(!f)return e.createElement(t.Card,null,e.createElement(t.BlockStack,{gap:"200"},e.createElement(t.Text,{variant:"headingMd"},u.Subscription),e.createElement(t.Text,null,u.NotSubscribed),e.createElement(t.InlineStack,{align:"end"},e.createElement(t.ButtonGroup,null,e.createElement(t.Button,{variant:"primary",onClick:i,accessibilityLabel:u.ChangePlan},u.SelectPlan)))));const{plan:v}=f,A=U(f.total,v.currency),D=v.interval===S.Annual?u.Year:u.Month,T=n==="horizontal"?t.InlineGrid:t.BlockStack,C=(_=f==null?void 0:f.appliedDiscount)==null?void 0:_.discount,k=C?C.percentage?`${C.percentage}%`:U(C.amount,v.currency):null,z=C&&f.appliedDiscount.discountEndsAt&&ue().isAfter(ue(f.appliedDiscount.discountEndsAt)),M=C?{xs:1,md:3}:{xs:1,md:2};return e.createElement(t.Card,null,e.createElement(t.BlockStack,{gap:"200"},e.createElement(t.Text,{variant:"headingMd"},u.Subscription),e.createElement(t.BlockStack,{gap:"400"},e.createElement(T,{columns:M,gap:"300"},e.createElement(t.BlockStack,null,e.createElement(t.Text,null,u.CurrentPlan),e.createElement(t.Text,{tone:"subdued"},v.name)),e.createElement(t.BlockStack,null,e.createElement(t.Text,null,u.Price),e.createElement(t.BlockStack,null,e.createElement(t.Text,{tone:"subdued"},u.AmountPerInterval.replace("{{ amount }}",A).replace("{{ interval }}",D)),C&&!z&&e.createElement(t.Text,{tone:"success"},u.DiscountAmount.replace("{{ amount }}",k)),C&&z&&e.createElement(t.Text,{tone:"subdued",textDecorationLine:"line-through"},u.DiscountAmountExpired.replace("{{ amount }}",k)))),v.usageCharges.length>0&&e.createElement(t.BlockStack,null,e.createElement(t.Text,null,u.UsageCharges||"Usage charges"),v.usageCharges.map((N,b)=>e.createElement(t.Text,{key:`usage-charge-${b}`,tone:"subdued"},N.terms)))),e.createElement(t.InlineStack,{align:"end"},e.createElement(t.ButtonGroup,null,e.createElement(t.Button,{onClick:()=>{m?m():p(!0)},accessibilityLabel:u.CancelPlan,tone:"critical"},u.CancelPlan),e.createElement(t.Button,{variant:"primary",onClick:i,accessibilityLabel:u.ChangePlan},u.ChangePlan))))),$&&e.createElement(t.Modal,{open:!0,onClose:()=>p(!1),title:u.CancelPlan,primaryAction:{content:u.CancelPlan,destructive:!0,loading:w,disabled:w,onAction:async()=>{x(!0),await g(),await P(),x(!1),p(!1),d()}},secondaryActions:[{content:u.Back,disabled:w,onAction:()=>p(!1)}]},e.createElement(t.Modal.Section,null,u.CancelConfirmation)))},Le=({backUrl:n="",pageWidth:i="narrow"})=>{const{cancelSubscription:m,i18n:d,subscription:g,refetch:u}=fe(),f=()=>{console.log("Show plans. Navigate to the plans page, open a modal, etc.")};return e.createElement(t.Page,{title:d.Subscription,backAction:n?{content:d.Back,url:n}:void 0,fullWidth:i==="full",narrowWidth:i==="narrow"},e.createElement(t.BlockStack,{gap:"400"},e.createElement(ce,{onShowPlans:f,cancelSubscription:m,i18n:d,subscription:g,refetch:u}),e.createElement(t.Layout,null,e.createElement(t.Layout.Section,null,e.createElement(ce,{onShowPlans:f,cancelSubscription:m,i18n:d,subscription:g,refetch:u})),e.createElement(t.Layout.Section,{variant:"oneThird"},e.createElement(ce,{onShowPlans:f,cancelSubscription:m,i18n:d,subscription:g,refetch:u,orientation:"vertical"})))))};exports.HighlightedPlanCards=De;exports.HorizontalPlanCard=he;exports.HorizontalPlanCards=we;exports.PlanCardStack=re;exports.PlanCardType=G;exports.PlanFeaturesSection=ge;exports.PlanPricingSection=me;exports.PlanTitleSection=de;exports.SubscriptionSummaryCard=ce;exports.SubscriptionSummaryPage=Le;exports.VerticalPlanCards=Te;
