"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("react"),t=require("@shopify/polaris");var de=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function me(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ge={exports:{}};(function(n,a){(function(o,i){n.exports=i()})(de,function(){var o=1e3,i=6e4,y=36e5,m="millisecond",u="second",A="minute",v="hour",x="day",I="week",P="month",L="quarter",D="year",g="date",h="Invalid Date",C=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,T={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(d){var l=["th","st","nd","rd"],r=d%100;return"["+d+(l[(r-20)%10]||l[r]||l[0])+"]"}},B=function(d,l,r){var s=String(d);return!s||s.length>=l?d:""+Array(l+1-s.length).join(r)+d},k={s:B,z:function(d){var l=-d.utcOffset(),r=Math.abs(l),s=Math.floor(r/60),c=r%60;return(l<=0?"+":"-")+B(s,2,"0")+":"+B(c,2,"0")},m:function d(l,r){if(l.date()<r.date())return-d(r,l);var s=12*(r.year()-l.year())+(r.month()-l.month()),c=l.clone().add(s,P),S=r-c<0,p=l.clone().add(s+(S?-1:1),P);return+(-(s+(r-c)/(S?c-p:p-c))||0)},a:function(d){return d<0?Math.ceil(d)||0:Math.floor(d)},p:function(d){return{M:P,y:D,w:I,d:x,D:g,h:v,m:A,s:u,ms:m,Q:L}[d]||String(d||"").toLowerCase().replace(/s$/,"")},u:function(d){return d===void 0}},E="en",f={};f[E]=T;var _="$isDayjsObject",W=function(d){return d instanceof $||!(!d||!d[_])},U=function d(l,r,s){var c;if(!l)return E;if(typeof l=="string"){var S=l.toLowerCase();f[S]&&(c=S),r&&(f[S]=r,c=S);var p=l.split("-");if(!c&&p.length>1)return d(p[0])}else{var H=l.name;f[H]=l,c=H}return!s&&c&&(E=c),c||!s&&E},O=function(d,l){if(W(d))return d.clone();var r=typeof l=="object"?l:{};return r.date=d,r.args=arguments,new $(r)},w=k;w.l=U,w.i=W,w.w=function(d,l){return O(d,{locale:l.$L,utc:l.$u,x:l.$x,$offset:l.$offset})};var $=function(){function d(r){this.$L=U(r.locale,null,!0),this.parse(r),this.$x=this.$x||r.x||{},this[_]=!0}var l=d.prototype;return l.parse=function(r){this.$d=function(s){var c=s.date,S=s.utc;if(c===null)return new Date(NaN);if(w.u(c))return new Date;if(c instanceof Date)return new Date(c);if(typeof c=="string"&&!/Z$/i.test(c)){var p=c.match(C);if(p){var H=p[2]-1||0,F=(p[7]||"0").substring(0,3);return S?new Date(Date.UTC(p[1],H,p[3]||1,p[4]||0,p[5]||0,p[6]||0,F)):new Date(p[1],H,p[3]||1,p[4]||0,p[5]||0,p[6]||0,F)}}return new Date(c)}(r),this.init()},l.init=function(){var r=this.$d;this.$y=r.getFullYear(),this.$M=r.getMonth(),this.$D=r.getDate(),this.$W=r.getDay(),this.$H=r.getHours(),this.$m=r.getMinutes(),this.$s=r.getSeconds(),this.$ms=r.getMilliseconds()},l.$utils=function(){return w},l.isValid=function(){return this.$d.toString()!==h},l.isSame=function(r,s){var c=O(r);return this.startOf(s)<=c&&c<=this.endOf(s)},l.isAfter=function(r,s){return O(r)<this.startOf(s)},l.isBefore=function(r,s){return this.endOf(s)<O(r)},l.$g=function(r,s,c){return w.u(r)?this[s]:this.set(c,r)},l.unix=function(){return Math.floor(this.valueOf()/1e3)},l.valueOf=function(){return this.$d.getTime()},l.startOf=function(r,s){var c=this,S=!!w.u(s)||s,p=w.p(r),H=function(V,G){var Z=w.w(c.$u?Date.UTC(c.$y,G,V):new Date(c.$y,G,V),c);return S?Z:Z.endOf(x)},F=function(V,G){return w.w(c.toDate()[V].apply(c.toDate("s"),(S?[0,0,0,0]:[23,59,59,999]).slice(G)),c)},z=this.$W,N=this.$M,j=this.$D,X="set"+(this.$u?"UTC":"");switch(p){case D:return S?H(1,0):H(31,11);case P:return S?H(1,N):H(0,N+1);case I:var J=this.$locale().weekStart||0,ne=(z<J?z+7:z)-J;return H(S?j-ne:j+(6-ne),N);case x:case g:return F(X+"Hours",0);case v:return F(X+"Minutes",1);case A:return F(X+"Seconds",2);case u:return F(X+"Milliseconds",3);default:return this.clone()}},l.endOf=function(r){return this.startOf(r,!1)},l.$set=function(r,s){var c,S=w.p(r),p="set"+(this.$u?"UTC":""),H=(c={},c[x]=p+"Date",c[g]=p+"Date",c[P]=p+"Month",c[D]=p+"FullYear",c[v]=p+"Hours",c[A]=p+"Minutes",c[u]=p+"Seconds",c[m]=p+"Milliseconds",c)[S],F=S===x?this.$D+(s-this.$W):s;if(S===P||S===D){var z=this.clone().set(g,1);z.$d[H](F),z.init(),this.$d=z.set(g,Math.min(this.$D,z.daysInMonth())).$d}else H&&this.$d[H](F);return this.init(),this},l.set=function(r,s){return this.clone().$set(r,s)},l.get=function(r){return this[w.p(r)]()},l.add=function(r,s){var c,S=this;r=Number(r);var p=w.p(s),H=function(N){var j=O(S);return w.w(j.date(j.date()+Math.round(N*r)),S)};if(p===P)return this.set(P,this.$M+r);if(p===D)return this.set(D,this.$y+r);if(p===x)return H(1);if(p===I)return H(7);var F=(c={},c[A]=i,c[v]=y,c[u]=o,c)[p]||1,z=this.$d.getTime()+r*F;return w.w(z,this)},l.subtract=function(r,s){return this.add(-1*r,s)},l.format=function(r){var s=this,c=this.$locale();if(!this.isValid())return c.invalidDate||h;var S=r||"YYYY-MM-DDTHH:mm:ssZ",p=w.z(this),H=this.$H,F=this.$m,z=this.$M,N=c.weekdays,j=c.months,X=c.meridiem,J=function(G,Z,ae,le){return G&&(G[Z]||G(s,S))||ae[Z].slice(0,le)},ne=function(G){return w.s(H%12||12,G,"0")},V=X||function(G,Z,ae){var le=G<12?"AM":"PM";return ae?le.toLowerCase():le};return S.replace(Y,function(G,Z){return Z||function(ae){switch(ae){case"YY":return String(s.$y).slice(-2);case"YYYY":return w.s(s.$y,4,"0");case"M":return z+1;case"MM":return w.s(z+1,2,"0");case"MMM":return J(c.monthsShort,z,j,3);case"MMMM":return J(j,z);case"D":return s.$D;case"DD":return w.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return J(c.weekdaysMin,s.$W,N,2);case"ddd":return J(c.weekdaysShort,s.$W,N,3);case"dddd":return N[s.$W];case"H":return String(H);case"HH":return w.s(H,2,"0");case"h":return ne(1);case"hh":return ne(2);case"a":return V(H,F,!0);case"A":return V(H,F,!1);case"m":return String(F);case"mm":return w.s(F,2,"0");case"s":return String(s.$s);case"ss":return w.s(s.$s,2,"0");case"SSS":return w.s(s.$ms,3,"0");case"Z":return p}return null}(G)||p.replace(":","")})},l.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},l.diff=function(r,s,c){var S,p=this,H=w.p(s),F=O(r),z=(F.utcOffset()-this.utcOffset())*i,N=this-F,j=function(){return w.m(p,F)};switch(H){case D:S=j()/12;break;case P:S=j();break;case L:S=j()/3;break;case I:S=(N-z)/6048e5;break;case x:S=(N-z)/864e5;break;case v:S=N/y;break;case A:S=N/i;break;case u:S=N/o;break;default:S=N}return c?S:w.a(S)},l.daysInMonth=function(){return this.endOf(P).$D},l.$locale=function(){return f[this.$L]},l.locale=function(r,s){if(!r)return this.$L;var c=this.clone(),S=U(r,s,!0);return S&&(c.$L=S),c},l.clone=function(){return w.w(this.$d,this)},l.toDate=function(){return new Date(this.valueOf())},l.toJSON=function(){return this.isValid()?this.toISOString():null},l.toISOString=function(){return this.$d.toISOString()},l.toString=function(){return this.$d.toUTCString()},d}(),Q=$.prototype;return O.prototype=Q,[["$ms",m],["$s",u],["$m",A],["$H",v],["$W",x],["$M",P],["$y",D],["$D",g]].forEach(function(d){Q[d[1]]=function(l){return this.$g(l,d[0],d[1])}}),O.extend=function(d,l){return d.$i||(d(l,$,O),d.$i=!0),O},O.locale=U,O.isDayjs=W,O.unix=function(d){return O(1e3*d)},O.en=f[E],O.Ls=f,O.p={},O})})(ge);var Se=ge.exports;const ce=me(Se),M={Annual:"ANNUAL",Every30Days:"EVERY_30_DAYS"},ee={Public:"public",CustomerTag:"customerTag",ShopifyPlan:"shopifyPlan",Customer:"customer",Hidden:"hidden"},b={AmountPerInterval:"{{ amount }} per {{ interval }}",Back:"Back",Cancel:"Cancel",CancelConfirmation:"Are you sure you want to cancel your subscription?",CancelPlan:"Cancel plan",ChangePlan:"Change plan",CurrentPlan:"Current plan",CustomPlans:"Custom plans",CustomPlansDescription:"Plans tailored to your specific needs",DiscountAmount:"{{ amount }} discount",DiscountAmountExpired:"{{ amount }} discount expired",FreeTrialLength:"{{ trialDays }}-day free trial",Features:"Features",Month:"month",MonthShort:"mo",Monthly:"Monthly",NextBillingDate:"Next billing date",NotSubscribed:"You're not subscribed to a plan yet.",Year:"year",YearShort:"yr",Yearly:"Yearly",MostPopular:"Most popular",Per:"/",Plans:"Plans",Price:"Price",SelectPlan:"Select plan",SubscribeSuccessTitle:"Subscription successful",SubscribeSuccessBody:"Thanks for subscribing to our app!",Subscription:"Subscription",SubscriptionCancelled:"Subscription cancelled",UsageCharges:"Usage charges"},pe=e.createContext(),be=()=>{const n=e.useContext(pe);if(n===void 0)throw new Error("useMantle must be used within a MantleProvider");return n},ke=(n="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:n,notation:"standard"}),R=(n,a="USD",o=!0)=>{let i=ke(a).format(n);return o&&(i=i.replace(/\.00$/,"")),i},Ce=(n=M.Every30Days)=>{switch(n){case M.Annual:return"year";case M.Every30Days:default:return"month"}},xe=(n=M.Every30Days)=>{switch(n){case M.Annual:return"yr";case M.Every30Days:default:return"mo"}},te=({interval:n=M.Every30Days,useShortFormPlanIntervals:a=!0})=>a?xe(n):Ce(n),se=({plan:n,customFieldKey:a="recommended"})=>{var o;return!!((o=n.customFields)!=null&&o[a])},ue=({plan:n,customFieldKey:a="buttonLabel"})=>{var o;return((o=n.customFields)==null?void 0:o[a])||b.SelectPlan},he=({plan:n})=>{var a;return((a=n.discounts)==null?void 0:a.length)>0?n.discounts.reduce((o,i)=>o.discountedAmount<i.discountedAmount?o:i):void 0},Be=(n=4)=>n%4===0?{xs:6,sm:6,md:2,lg:3,xl:3}:n%3===0?{xs:6,sm:6,md:2,lg:4,xl:4}:n%2===0?{xs:6,sm:6,md:3,lg:6,xl:6}:n===1?{xs:6,sm:6,md:6,lg:12,xl:12}:{xs:6,sm:6,md:2,lg:4,xl:4},Pe=(n=4)=>n%4===0?4:n%3===0?3:n%2===0?2:n===1?1:4,De=({orientation:n="horizontal",onShowPlans:a,onCancelPlan:o,onPlanCancelled:i=()=>{},cancelSubscription:y=async()=>{},i18n:m,subscription:u,refetch:A=async()=>{},apps:v=[]})=>e.createElement(t.Banner,{title:"Bundle and save!",tone:"success"},e.createElement(t.BlockStack,{gap:"400"},e.createElement(t.Text,null,"Save money on your subscription when you install these great apps."),e.createElement(t.BlockStack,{gap:"300"},v.map((x,I)=>e.createElement(t.BlockStack,{gap:"300"},e.createElement(t.InlineStack,{gap:"200",align:"space-between",blockAlign:"center"},e.createElement(t.InlineStack,{gap:"300"},e.createElement(t.Thumbnail,{source:x.iconUrl,alt:x.name,size:"small"}),e.createElement(t.BlockStack,null,e.createElement(t.Text,{variant:"headingSm"},x.name),e.createElement(t.Text,null,x.description))),e.createElement(t.InlineStack,{gap:"400"},e.createElement(t.Text,{tone:"subdued"},"20% off"),e.createElement(t.BlockStack,null,e.createElement(t.Button,null,m.Install)))),I<v.length-1&&e.createElement(t.Divider,null))))));var q=function(a){return e.createElement("svg",Object.assign({viewBox:"0 0 20 20"},a),e.createElement("path",{fillRule:"evenodd",d:"M15.78 5.97a.75.75 0 0 1 0 1.06l-6.5 6.5a.75.75 0 0 1-1.06 0l-3.25-3.25a.75.75 0 1 1 1.06-1.06l2.72 2.72 5.97-5.97a.75.75 0 0 1 1.06 0Z"}))};q.displayName="CheckIcon";var ie=function(a){return e.createElement("svg",Object.assign({viewBox:"0 0 20 20"},a),e.createElement("path",{d:"M10.75 6.75a.75.75 0 0 0-1.5 0v2.5h-2.5a.75.75 0 0 0 0 1.5h2.5v2.5a.75.75 0 0 0 1.5 0v-2.5h2.5a.75.75 0 0 0 0-1.5h-2.5v-2.5Z"}))};ie.displayName="PlusIcon";const $e=({plan:n,t:a,translatePlanName:o,planNameTextVariant:i,planDescriptionTextVariant:y})=>e.createElement(t.BlockStack,{gap:"100"},e.createElement(t.Text,{variant:i,alignment:"center"},o?a(n.name):n.name),n.description&&e.createElement(t.Text,{variant:y,tone:"subdued",alignment:"center"},a(n.description))),Me=({plan:n,discount:a,t:o,priceTextVariant:i,useShortFormPlanIntervals:y=!0})=>e.createElement(t.BlockStack,{gap:"100"},!!a&&e.createElement(t.InlineStack,{align:"center",blockAlign:"center",gap:"200"},e.createElement(t.Text,{variant:i},R(a.presentmentDiscountedAmount,n.presentmentCurrencyCode,!0)),e.createElement(t.Text,{variant:i,tone:"subdued",fontWeight:"medium",textDecorationLine:"line-through"},R(n.presentmentAmount,n.presentmentCurrencyCode,!0)),e.createElement(t.Text,{variant:"bodyLg",tone:"subdued"},o(b.Per)," ",o(te({interval:n.interval,useShortFormPlanIntervals:y})))),!a&&e.createElement(t.InlineStack,{align:"center",blockAlign:"center",gap:"200"},e.createElement(t.Text,{alignment:"center",variant:i},R(n.presentmentAmount,n.presentmentCurrencyCode,!0)),e.createElement(t.Text,{alignment:"center",variant:"bodyLg",tone:"subdued"},o(b.Per)," ",o(te({interval:n.interval,useShortFormPlanIntervals:y})))),n.usageCharges.length>0&&e.createElement(t.BlockStack,null,n.usageCharges.map((m,u)=>e.createElement(t.InlineStack,{key:`plan-usageCharge-${u}`,align:"center",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:ie,tone:"subdued"})),e.createElement(t.Text,{variant:"bodyLg"},o(m.terms)))))),we=({plan:n,t:a,trialDaysAsFeature:o=!1})=>e.createElement(t.BlockStack,{gap:"300"},o&&n.trialDays&&n.trialDays>0?e.createElement(t.InlineStack,{align:"center",blockAlign:"center",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:q,tone:"subdued"})),e.createElement(t.Text,null,a(b.FreeTrialLength).replace("{{ trialDays }}",n.trialDays))):null,n.featuresOrder.map((i,y)=>{const m=n.features[i];if(m.type!=="boolean"||m.value===!0)return e.createElement(t.InlineStack,{key:`plan-feature-${y}`,align:"center",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:q,tone:"subdued"})),m.type==="boolean"?e.createElement(t.Text,null,a(m.name)):e.createElement(t.Text,null,m.value," ",a(m.name)))})),ye=({plan:n,discount:a,buttonLabel:o,onSelectPlan:i,useShortFormPlanIntervals:y=!0,trialDaysAsFeature:m=!1,expanded:u=!1,isActivePlan:A=!1,isRecommendedPlan:v=!1,isCustomPlan:x=!1,showRecommendedPlanBadge:I=!0,t:P,translatePlanName:L=!0,planNameTextVariant:D="headingMd",planDescriptionTextVariant:g="bodyLg",priceTextVariant:h="heading3xl"})=>{const[C,Y]=e.useState(!1),T=P||(k=>k),B=async({plan:k,discount:E})=>{i?(Y(!0),await i({plan:k,discount:E})!==!0&&Y(!1)):console.log("No onSelectPlan callback provided")};return e.createElement(t.Box,{position:"relative",minHeight:"100%"},e.createElement(t.Box,{paddingBlock:u||v?void 0:"800",minHeight:"100%"},e.createElement(t.Box,{background:v||x?"bg-surface":"bg-surface-secondary",borderStyle:"solid",borderColor:"border",borderWidth:"025",paddingBlock:u||v?"1600":"800",paddingInline:"400",borderRadius:"200",minHeight:"calc(100% - calc(var(--p-space-800) * 2))"},e.createElement(t.BlockStack,{gap:"800"},e.createElement(t.BlockStack,{gap:"400"},e.createElement($e,{plan:n,t:T,translatePlanName:L,planNameTextVariant:D,planDescriptionTextVariant:g}),e.createElement(Me,{plan:n,discount:a,useShortFormPlanIntervals:y,t:T,priceTextVariant:h})),e.createElement(t.Button,{size:"large",variant:v?"primary":"secondary",onClick:async()=>{await B({plan:n,discount:a})},disabled:A,loading:C},T(o||b.SelectPlan)),e.createElement(we,{plan:n,t:T,trialDaysAsFeature:m}),v&&I&&e.createElement(t.InlineStack,{align:"center",gap:"100"},e.createElement(t.Badge,{tone:"success"},T(b.MostPopular)))))))},K={Highlighted:"highlighted",Horizontal:"horizontal",Vertical:"vertical"},re=({plans:n,customer:a,onSelectPlan:o,planInterval:i,cardType:y=K.Horizontal,trialDaysAsFeature:m=!0,useShortFormPlanIntervals:u=!0,keyForRecommended:A="recommended",keyForCustomButtonLabel:v="buttonLabel",showRecommendedPlanBadge:x=!0,applyDiscount:I=!0,t:P,translatePlanName:L=!0})=>{var B;const D=(B=a==null?void 0:a.subscription)!=null&&B.active?a.subscription:void 0,g=D==null?void 0:D.plan,h=i?n.filter(k=>k.interval===i):n,C=y===K.Vertical?1:Pe(h.length),Y=Be(C),T=P||(k=>k);return e.createElement(t.Grid,{columns:C},h.map(k=>{const E=I?he({plan:k}):void 0,f=(g==null?void 0:g.id)===k.id&&!(D!=null&&D.cancelOn);return e.createElement(t.Grid.Cell,{columnSpan:Y,key:k.id},y===K.Highlighted&&e.createElement(ye,{key:`HighlightedPlanCard-${k.id}`,plan:k,discount:E,onSelectPlan:o,isActivePlan:f,trialDaysAsFeature:m,useShortFormPlanIntervals:u,isCustomPlan:k.availability!==ee.Public,isRecommendedPlan:se({plan:k,customFieldKey:A}),buttonLabel:ue({plan:k,customFieldKey:v}),showRecommendedPlanBadge:x,t:T,translatePlanName:L}),y===K.Horizontal&&e.createElement(fe,{key:`HorizontalPlanCard-${k.id}`,plan:k,discount:E,onSelectPlan:o,isActivePlan:f,trialDaysAsFeature:m,useShortFormPlanIntervals:u,isRecommendedPlan:se({plan:k,customFieldKey:A}),buttonLabel:ue({plan:k,customFieldKey:v}),showRecommendedPlanBadge:x,t:T,translatePlanName:L}))}))},Te=({customer:n,plans:a,onSubscribe:o,backUrl:i="",showRecommendedBadge:y=!0,customFieldCta:m,customFieldPlanRecommended:u="Recommended",showPlanIntervalToggle:A=!0,showTrialDaysAsFeature:v=!0,useShortFormPlanIntervals:x,pageWidth:I="default",showCustomPlans:P=!0})=>{const L=n==null?void 0:n.subscription,D=new URLSearchParams(window.location.search),g=a.some(f=>f.interval===M.Annual)&&a.some(f=>f.interval===M.Every30Days),h=a.find(f=>f.id===(L==null?void 0:L.plan.id)),[C,Y]=e.useState(h?h.interval:g?M.Annual:M.Every30Days),T=a.filter(f=>f.availability===ee.Public),B=P?a.filter(f=>f.availability!==ee.Public):[],[k,E]=e.useState(D.get("subscribed")==="true");return e.createElement(t.Page,{title:b.Plans,backAction:i?{content:b.Back,url:i}:void 0,secondaryActions:A&&g?e.createElement(t.ButtonGroup,{variant:"segmented"},e.createElement(t.Button,{pressed:C===M.Every30Days,onClick:()=>Y(M.Every30Days)},b.Monthly),e.createElement(t.Button,{pressed:C===M.Annual,onClick:()=>Y(M.Annual)},b.Yearly)):void 0,fullWidth:I==="full",narrowWidth:I==="narrow"},e.createElement(t.Layout,null,e.createElement(t.Layout.Section,null,e.createElement(t.BlockStack,{gap:"1000"},k&&e.createElement(t.Banner,{tone:"success",title:b.SubscribeSuccessTitle,onDismiss:()=>{E(!1),window.history.replaceState({},document.title,window.location.pathname)}},b.SubscribeSuccessBody),e.createElement(re,{plans:T,onSelectPlan:o,planInterval:C,cardType:K.Horizontal,keyForRecommended:u,keyForCustomButtonLabel:m,trialDaysAsFeature:v,useShortFormPlanIntervals:x,showRecommendedPlanBadge:y}),(B==null?void 0:B.length)>0&&e.createElement(t.Divider,{borderColor:"border"}),(B==null?void 0:B.length)>0&&e.createElement(t.BlockStack,{gap:"300"},e.createElement(t.Box,{paddingInline:{xs:400,sm:0}},e.createElement(t.Text,{variant:"headingMd"},b.CustomPlans)),e.createElement(re,{plans:B,onSelectPlan:o,planInterval:C,cardType:K.Horizontal,keyForRecommended:u,keyForCustomButtonLabel:m,trialDaysAsFeature:v,useShortFormPlanIntervals:x,showRecommendedPlanBadge:y}))))))},Ae=({plan:n,t:a,translatePlanName:o,isRecommendedPlan:i=!1,planNameTextVariant:y,planDescriptionTextVariant:m,showRecommendedPlanBadge:u})=>e.createElement(t.BlockStack,{gap:"100"},e.createElement(t.InlineStack,{align:"space-between",gap:"100"},e.createElement(t.Text,{variant:y},o?a(n.name):n.name),i&&u&&e.createElement(t.Badge,{tone:"success"},a(b.MostPopular))),n.description&&e.createElement(t.Text,{variant:m,tone:"subdued"},a(n.description))),Le=({plan:n,discount:a,t:o,useShortFormPlanIntervals:i=!0,priceTextVariant:y})=>e.createElement(t.BlockStack,null,!!a&&a.presentmentDiscountedAmount>0&&e.createElement(t.InlineStack,{blockAlign:"center",gap:"200"},e.createElement(t.Text,{variant:y},R(a.presentmentDiscountedAmount,n.presentmentCurrencyCode)),e.createElement(t.Text,{variant:y,tone:"subdued",fontWeight:"medium",textDecorationLine:"line-through"},n.presentmentAmount),e.createElement(t.Text,{variant:"bodyLg",tone:"subdued"},o(b.Per)," ",o(te({interval:n.interval,useShortFormPlanIntervals:i})))),(!a||a.presentmentDiscountedAmount==0)&&e.createElement(t.InlineStack,{blockAlign:"center",gap:"200"},e.createElement(t.Text,{alignment:"center",variant:y},R(n.presentmentAmount,n.presentmentCurrencyCode)),e.createElement(t.Text,{alignment:"center",variant:"bodyLg",tone:"subdued"},o(b.Per)," ",o(te({interval:n.interval,useShortFormPlanIntervals:i})))),n.usageCharges&&n.usageCharges.length>0&&e.createElement(t.BlockStack,null,n.usageCharges.map((m,u)=>e.createElement(t.InlineStack,{key:`plan-usageCharge-${u}`,align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:ie,tone:"subdued"})),e.createElement(t.Text,{variant:"bodyLg"},o(m.terms)))))),Ie=({plan:n,t:a,trialDaysAsFeature:o=!1})=>e.createElement(t.BlockStack,{gap:"100"},o&&n.trialDays&&n.trialDays>0?e.createElement(t.InlineStack,{align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:q,tone:"subdued"})),e.createElement(t.Text,null,a(b.FreeTrialLength).replace("{{ trialDays }}",n.trialDays))):null,n.featuresOrder.map((i,y)=>{const m=n.features[i];if(m.type!=="boolean"||m.value===!0)return e.createElement(t.InlineStack,{key:`plan-feature-${y}`,align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:q,tone:"subdued"})),m.type==="boolean"?e.createElement(t.Text,null,a(m.name)):e.createElement(t.Text,null,m.value," ",a(m.name)))})),fe=({plan:n,discount:a,buttonLabel:o,onSelectPlan:i,useShortFormPlanIntervals:y=!0,trialDaysAsFeature:m=!1,isRecommendedPlan:u=!1,isActivePlan:A=!1,t:v,translatePlanName:x=!0,showRecommendedPlanBadge:I=!0,planNameTextVariant:P="bodyLg",planDescriptionTextVariant:L="bodyMd",priceTextVariant:D="headingXl"})=>{const[g,h]=e.useState(!1),C=v||(T=>T),Y=async({plan:T,discount:B})=>{i?(h(!0),await i({plan:T,discount:B})!==!0&&h(!1)):console.log("No onSelectPlan callback provided")};return e.createElement(t.Card,null,e.createElement(t.BlockStack,{gap:"400"},e.createElement(Ae,{plan:n,isRecommendedPlan:u,showRecommendedPlanBadge:I,t:C,translatePlanName:x,planNameTextVariant:P,planDescriptionTextVariant:L}),e.createElement(Le,{plan:n,discount:a,useShortFormPlanIntervals:y,t:C,priceTextVariant:D}),e.createElement(t.Button,{size:"large",variant:u?"primary":"secondary",onClick:async()=>{await Y({plan:n,discount:a})},disabled:A,loading:g},C(A?b.CurrentPlan:o||b.SelectPlan)),e.createElement(Ie,{plan:n,trialDaysAsFeature:m,t:C})))},Ye=({customer:n,plans:a,onSubscribe:o,backUrl:i="",showRecommendedBadge:y=!0,customFieldCta:m=null,customFieldPlanRecommended:u="Recommended",showPlanIntervalToggle:A=!0,showTrialDaysAsFeature:v=!0,useShortFormPlanIntervals:x=!0,pageWidth:I="default",showCustomPlans:P=!0})=>{const L=n==null?void 0:n.subscription,D=new URLSearchParams(window.location.search),g=a.some(f=>f.interval===M.Annual)&&a.some(f=>f.interval===M.Every30Days),h=a.find(f=>f.id===(L==null?void 0:L.plan.id)),[C,Y]=e.useState(h?h.interval:g?M.Annual:M.Every30Days),T=a.filter(f=>f.availability===ee.Public),B=P?a.filter(f=>f.availability!==ee.Public):[],[k,E]=e.useState(D.get("subscribed")==="true");return e.createElement(t.Page,{title:b.Plans,backAction:i&&i!==""?{content:b.Back,url:i}:void 0,secondaryActions:A&&g?e.createElement(t.ButtonGroup,{variant:"segmented"},e.createElement(t.Button,{pressed:C===M.Every30Days,onClick:()=>Y(M.Every30Days)},b.Monthly),e.createElement(t.Button,{pressed:C===M.Annual,onClick:()=>Y(M.Annual)},b.Yearly)):void 0,fullWidth:I==="full",narrowWidth:I==="narrow"},e.createElement(t.Box,{paddingBlockEnd:"800"},e.createElement(t.Layout,null,e.createElement(t.Layout.Section,null,e.createElement(t.BlockStack,{gap:"1000"},k&&e.createElement(t.Banner,{tone:"success",title:b.SubscribeSuccessTitle,onDismiss:()=>{E(!1),window.history.replaceState({},document.title,window.location.pathname)}},b.SubscribeSuccessBody),e.createElement(re,{plans:T,onSelectPlan:o,planInterval:C,cardType:K.Highlighted,keyForRecommended:u,keyForCustomButtonLabel:m,trialDaysAsFeature:v,useShortFormPlanIntervals:x,showRecommendedPlanBadge:y}),(B==null?void 0:B.length)>0&&e.createElement(t.Divider,{borderColor:"border"}),(B==null?void 0:B.length)>0&&e.createElement(t.BlockStack,{gap:"300"},e.createElement(t.Box,{paddingInline:{xs:400,sm:0}},e.createElement(t.Text,{variant:"headingMd"},b.CustomPlans)),e.createElement(re,{plans:B,onSelectPlan:o,planInterval:C,cardType:K.Highlighted,keyForRecommended:u,keyForCustomButtonLabel:m,trialDaysAsFeature:v,useShortFormPlanIntervals:x,showRecommendedPlanBadge:y})))))))},Ee=({plan:n,discount:a,buttonLabel:o,onSelectPlan:i,useShortFormPlanIntervals:y=!0,trialDaysAsFeature:m=!1,isRecommendedPlan:u=!1,isActivePlan:A=!1,t:v=_t,translatePlanName:x=!0,showRecommendedPlanBadge:I=!0,planNameTextVariant:P="bodyLg",planDescriptionTextVariant:L="bodyMd",priceTextVariant:D="headingXl"})=>{const[g,h]=e.useState(!1),C=async({plan:E,discount:f})=>{i?(h(!0),await i({plan:E,discount:f})!==!0&&h(!1)):console.log("No onSelectPlan callback provided")},Y=({plan:E})=>e.createElement(t.BlockStack,null,e.createElement(t.Text,{variant:P},x?v(E.name):E.name),E.description&&e.createElement(t.Text,{variant:L,tone:"subdued"},v(E.description))),T=({plan:E})=>e.createElement(t.BlockStack,{gap:"200"},e.createElement(t.Text,{fontWeight:"medium"},v(b.Features)),e.createElement(t.BlockStack,{gap:"100"},m&&E.trialDays&&E.trialDays>0?e.createElement(t.InlineStack,{align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:q,tone:"positive"})),e.createElement(t.Text,{tone:"subdued"},v(b.FreeTrialLength.replace("{{ trialDays }}",E.trialDays)))):null,E.featuresOrder.map((f,_)=>{const W=E.features[f];if(W.type!=="boolean"||W.value===!0)return e.createElement(t.InlineStack,{key:`plan-feature-${_}`,align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:q,tone:"positive"})),W.type==="boolean"?e.createElement(t.Text,{tone:"subdued"},W.name):e.createElement(t.Text,{tone:"subdued"},W.value," ",W.name))}))),B=({plan:E,discount:f})=>e.createElement(t.BlockStack,{gap:"100"},f?e.createElement(t.InlineStack,{blockAlign:"center",gap:"200"},e.createElement(t.Text,{variant:D},R(f.presentmentDiscountedAmount,E.presentmentCurrencyCode)),e.createElement(t.Text,{variant:D,tone:"subdued",fontWeight:"medium",textDecorationLine:"line-through"},E.presentmentAmount),e.createElement(t.Text,{variant:"bodyLg",tone:"subdued"},b.Per," ",te({interval:E.interval,useShortFormPlanIntervals:y}))):e.createElement(t.InlineStack,{blockAlign:"center",gap:"200"},e.createElement(t.Text,{alignment:"center",variant:D},R(E.presentmentAmount,E.presentmentCurrencyCode)),e.createElement(t.Text,{alignment:"center",variant:"bodyLg",tone:"subdued"},b.Per," ",te({interval:E.interval,useShortFormPlanIntervals:y}))),E.usageCharges.length>0&&e.createElement(t.BlockStack,null,E.usageCharges.map((_,W)=>e.createElement(t.InlineStack,{key:`plan-usageCharge-${W}`,align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:ie,tone:"positive"})),e.createElement(t.Text,{variant:"bodyLg"},_.terms))))),k=({plan:E,discount:f})=>e.createElement(t.InlineStack,{blockAlign:"center",gap:"400"},e.createElement(t.Button,{size:"large",variant:u?"primary":"secondary",onClick:async()=>{await C({plan:E,discount:f})},disabled:A,loading:g},v(A?b.CurrentPlan:o||b.SelectPlan)),u&&I&&e.createElement(t.Badge,{tone:"success"},v(b.MostPopular)));return e.createElement(t.Card,null,e.createElement(t.Grid,null,e.createElement(t.Grid.Cell,{columnSpan:{xs:6,sm:6,md:3,lg:6,xl:6}},e.createElement(t.BlockStack,{gap:"300"},Y({plan:n}),B({plan:n,discount:a}),e.createElement(t.Box,null,k({plan:n,discount:a})))),e.createElement(t.Grid.Cell,{columnSpan:{xs:6,sm:6,md:3,lg:6,xl:6}},T({plan:n}))))},He=({plans:n,customer:a,onSubscribe:o,backUrl:i="",keyForRecommended:y="recommended",keyForCustomButtonLabel:m="buttonLabel",showPlanIntervalToggle:u=!1,trialDaysAsFeature:A=!0,useShortFormPlanIntervals:v=!0,pageWidth:x="default",showCustomPlans:I=!0,showRecommendedPlanBadge:P=!0,applyDiscount:L=!0,t:D,translatePlanName:g=!0})=>{var w;const h=new URLSearchParams(window.location.search),C=n.some($=>$.interval===M.Annual)&&n.some($=>$.interval===M.Every30Days),Y=(w=a==null?void 0:a.subscription)!=null&&w.active?a.subscription:void 0,T=Y==null?void 0:Y.plan,[B,k]=e.useState(T?T.interval:C?M.Annual:M.Every30Days),E=n.filter($=>$.availability!=="customerTag"&&$.availability!=="customer"),f=u&&C?E.filter($=>$.interval===B):E,_=I?n.filter($=>$.availability==="customerTag"||$.availability==="customer"):[],[W,U]=e.useState(h.get("subscribed")==="true"),O=D||($=>$);return e.createElement(t.Page,{title:b.Plans,backAction:i!==""?{content:b.Back,url:i}:void 0,secondaryActions:u&&C?e.createElement(t.ButtonGroup,{variant:"segmented"},e.createElement(t.Button,{pressed:B===M.Every30Days,onClick:()=>k(M.Every30Days)},b.Monthly),e.createElement(t.Button,{pressed:B===M.Annual,onClick:()=>k(M.Annual)},b.Year)):void 0,fullWidth:x==="full",narrowWidth:x==="narrow"},e.createElement(t.Layout,null,e.createElement(t.Layout.Section,null,e.createElement(t.BlockStack,{gap:"400"},W&&e.createElement(t.Banner,{tone:"success",title:b.SubscribeSuccessTitle,onDismiss:()=>{U(!1),window.history.replaceState({},document.title,window.location.pathname)}},b.SubscribeSuccessBody),f.map(($,Q)=>{const d=L?he({plan:$}):void 0,l=(T==null?void 0:T.id)===$.id&&!(Y!=null&&Y.cancelOn);return e.createElement(Ee,{key:`plan-${Q}`,plan:$,discount:d,onSelectPlan:o,isActivePlan:l,trialDaysAsFeature:A,useShortFormPlanIntervals:v,isCustomPlan:$.availability!==ee.Public,isRecommendedPlan:se({plan:$,customFieldKey:y}),buttonLabel:ue({plan:$,customFieldKey:m}),showRecommendedPlanBadge:P,t:O,translatePlanName:g})}),(_==null?void 0:_.length)>0&&e.createElement(t.Divider,{borderColor:"border"}),(_==null?void 0:_.length)>0&&e.createElement(t.BlockStack,{gap:"300"},e.createElement(t.Box,{paddingInline:{xs:400,sm:0}},e.createElement(t.Text,{variant:"headingMd"},b.CustomPlans)),e.createElement(t.Grid,null,_.map(($,Q)=>{var l;const d=((l=$.discounts)==null?void 0:l.length)>0?$.discounts.reduce((r,s)=>r.discountedAmount<s.discountedAmount?r:s):null;return e.createElement(t.Grid.Cell,{key:`custom-plan-${Q}`,columnSpan:columnSpan()},e.createElement(t.Card,null,e.createElement(t.BlockStack,{gap:"400"},titleComponent({plan:$,discount:d}),pricingComponent({plan:$,discount:d}),ctaComponent({plan:$,discount:d}),featuresComponent({plan:$,discount:d}))))})))))))};var ve={exports:{}};(function(n,a){(function(o,i){n.exports=i()})(de,function(){var o={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(i,y,m){var u=y.prototype,A=u.format;m.en.formats=o,u.format=function(v){v===void 0&&(v="YYYY-MM-DDTHH:mm:ssZ");var x=this.$locale().formats,I=function(P,L){return P.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(D,g,h){var C=h&&h.toUpperCase();return g||L[h]||o[h]||L[C].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(Y,T,B){return T||B.slice(1)})})}(v,x===void 0?{}:x);return A.call(this,I)}}})})(ve);var Oe=ve.exports;const Fe=me(Oe);ce.extend(Fe);const oe=({orientation:n="horizontal",onShowPlans:a,onCancelPlan:o,onPlanCancelled:i=()=>{},cancelSubscription:y=async()=>{},i18n:m,subscription:u,refetch:A=async()=>{},t:v,translatePlanName:x=!0})=>{var W;const[I,P]=e.useState(!1),[L,D]=e.useState(!1),g=v||(U=>U),h={...b,...m||{}};if(!u)return e.createElement(t.Card,null,e.createElement(t.BlockStack,{gap:"200"},e.createElement(t.Text,{variant:"headingMd"},g(h.Subscription)),e.createElement(t.Text,null,g(h.NotSubscribed)),e.createElement(t.InlineStack,{align:"end"},e.createElement(t.ButtonGroup,null,e.createElement(t.Button,{variant:"primary",onClick:a,accessibilityLabel:g(h.ChangePlan)},g(h.SelectPlan))))));const{plan:C}=u,Y=R(u.presentmentTotal,C.presentmentCurrencyCode),T=g(C.interval===M.Annual?h.Year:h.Month),B=n==="horizontal"?t.InlineGrid:t.BlockStack,k=(W=u==null?void 0:u.appliedDiscount)==null?void 0:W.discount,E=k?k.percentage?`${k.percentage}%`:R(k.presentmentAmount,C.presentmentCurrencyCode):null,f=k&&u.appliedDiscount.discountEndsAt&&ce().isAfter(ce(u.appliedDiscount.discountEndsAt)),_=C.usageCharges.length>0?{xs:1,md:3}:{xs:1,md:2};return e.createElement(t.Card,null,e.createElement(t.BlockStack,{gap:"200"},e.createElement(t.Text,{variant:"headingMd"},g(h.Subscription)),e.createElement(t.BlockStack,{gap:"400"},e.createElement(B,{columns:_,gap:"300"},e.createElement(t.BlockStack,null,e.createElement(t.Text,null,g(h.CurrentPlan)),e.createElement(t.Text,{tone:"subdued"},x?g(C.name):C.name),u.cancelOn&&e.createElement(t.Text,{tone:"subdued"},g("Canceled, active until {{ date }}").replace("{{ date }}",ce(u.cancelOn).format("LL")))),e.createElement(t.BlockStack,null,e.createElement(t.Text,null,g(h.Price)),e.createElement(t.BlockStack,null,e.createElement(t.Text,{tone:"subdued"},g(h.AmountPerInterval).replace("{{ amount }}",Y).replace("{{ interval }}",T)),k&&!f&&e.createElement(t.Text,{tone:"success"},g(h.DiscountAmount).replace("{{ amount }}",E)),k&&f&&e.createElement(t.Text,{tone:"subdued",textDecorationLine:"line-through"},g(h.DiscountAmountExpired).replace("{{ amount }}",E)))),C.usageCharges.length>0&&e.createElement(t.BlockStack,null,e.createElement(t.Text,null,g(h.UsageCharges||"Usage charges")),C.usageCharges.map((U,O)=>e.createElement(t.Text,{key:`usage-charge-${O}`,tone:"subdued"},g(U.terms))))),e.createElement(t.InlineStack,{align:"end"},e.createElement(t.ButtonGroup,null,e.createElement(t.Button,{onClick:()=>{o?o():P(!0)},accessibilityLabel:g(h.CancelPlan),tone:"critical",disabled:!!u.cancelOn},g(h.CancelPlan)),e.createElement(t.Button,{variant:"primary",onClick:a,accessibilityLabel:g(h.ChangePlan)},g(h.ChangePlan)))))),I&&e.createElement(t.Modal,{open:!0,onClose:()=>P(!1),title:g(h.CancelPlan),primaryAction:{content:g(h.CancelPlan),destructive:!0,loading:L,disabled:L,onAction:async()=>{D(!0),await y(),await A(),D(!1),P(!1),i()}},secondaryActions:[{content:g(h.Back),disabled:L,onAction:()=>P(!1)}]},e.createElement(t.Modal.Section,null,g(h.CancelConfirmation))))},ze=({backUrl:n="",pageWidth:a="narrow"})=>{const{cancelSubscription:o,i18n:i,subscription:y,refetch:m}=be(),u=()=>{console.log("Show plans. Navigate to the plans page, open a modal, etc.")};return e.createElement(t.Page,{title:i.Subscription,backAction:n?{content:i.Back,url:n}:void 0,fullWidth:a==="full",narrowWidth:a==="narrow"},e.createElement(t.BlockStack,{gap:"400"},e.createElement(oe,{onShowPlans:u,cancelSubscription:o,i18n:i,subscription:y,refetch:m}),e.createElement(t.Layout,null,e.createElement(t.Layout.Section,null,e.createElement(oe,{onShowPlans:u,cancelSubscription:o,i18n:i,subscription:y,refetch:m})),e.createElement(t.Layout.Section,{variant:"oneThird"},e.createElement(oe,{onShowPlans:u,cancelSubscription:o,i18n:i,subscription:y,refetch:m,orientation:"vertical"})))))};exports.BundleCard=De;exports.HighlightedPlanCard=ye;exports.HighlightedPlanCards=Ye;exports.HorizontalPlanCard=fe;exports.HorizontalPlanCards=Te;exports.PlanCardStack=re;exports.PlanCardType=K;exports.SubscriptionSummaryCard=oe;exports.SubscriptionSummaryPage=ze;exports.VerticalPlanCard=Ee;exports.VerticalPlanCards=He;
