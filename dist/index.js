"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("react"),t=require("@shopify/polaris");var de=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function me(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ge={exports:{}};(function(n,a){(function(o,i){n.exports=i()})(de,function(){var o=1e3,i=6e4,E=36e5,m="millisecond",d="second",B="minute",v="hour",C="day",A="week",M="month",L="quarter",T="year",x="date",g="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,P=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(f){var l=["th","st","nd","rd"],r=f%100;return"["+f+(l[(r-20)%10]||l[r]||l[0])+"]"}},S=function(f,l,r){var u=String(f);return!u||u.length>=l?f:""+Array(l+1-u.length).join(r)+f},_={s:S,z:function(f){var l=-f.utcOffset(),r=Math.abs(l),u=Math.floor(r/60),c=r%60;return(l<=0?"+":"-")+S(u,2,"0")+":"+S(c,2,"0")},m:function f(l,r){if(l.date()<r.date())return-f(r,l);var u=12*(r.year()-l.year())+(r.month()-l.month()),c=l.clone().add(u,M),b=r-c<0,p=l.clone().add(u+(b?-1:1),M);return+(-(u+(r-c)/(b?c-p:p-c))||0)},a:function(f){return f<0?Math.ceil(f)||0:Math.floor(f)},p:function(f){return{M,y:T,w:A,d:C,D:x,h:v,m:B,s:d,ms:m,Q:L}[f]||String(f||"").toLowerCase().replace(/s$/,"")},u:function(f){return f===void 0}},y="en",s={};s[y]=Y;var z="$isDayjsObject",O=function(f){return f instanceof J||!(!f||!f[z])},W=function f(l,r,u){var c;if(!l)return y;if(typeof l=="string"){var b=l.toLowerCase();s[b]&&(c=b),r&&(s[b]=r,c=b);var p=l.split("-");if(!c&&p.length>1)return f(p[0])}else{var I=l.name;s[I]=l,c=I}return!u&&c&&(y=c),c||!u&&y},H=function(f,l){if(O(f))return f.clone();var r=typeof l=="object"?l:{};return r.date=f,r.args=arguments,new J(r)},$=_;$.l=W,$.i=O,$.w=function(f,l){return H(f,{locale:l.$L,utc:l.$u,x:l.$x,$offset:l.$offset})};var J=function(){function f(r){this.$L=W(r.locale,null,!0),this.parse(r),this.$x=this.$x||r.x||{},this[z]=!0}var l=f.prototype;return l.parse=function(r){this.$d=function(u){var c=u.date,b=u.utc;if(c===null)return new Date(NaN);if($.u(c))return new Date;if(c instanceof Date)return new Date(c);if(typeof c=="string"&&!/Z$/i.test(c)){var p=c.match(h);if(p){var I=p[2]-1||0,F=(p[7]||"0").substring(0,3);return b?new Date(Date.UTC(p[1],I,p[3]||1,p[4]||0,p[5]||0,p[6]||0,F)):new Date(p[1],I,p[3]||1,p[4]||0,p[5]||0,p[6]||0,F)}}return new Date(c)}(r),this.init()},l.init=function(){var r=this.$d;this.$y=r.getFullYear(),this.$M=r.getMonth(),this.$D=r.getDate(),this.$W=r.getDay(),this.$H=r.getHours(),this.$m=r.getMinutes(),this.$s=r.getSeconds(),this.$ms=r.getMilliseconds()},l.$utils=function(){return $},l.isValid=function(){return this.$d.toString()!==g},l.isSame=function(r,u){var c=H(r);return this.startOf(u)<=c&&c<=this.endOf(u)},l.isAfter=function(r,u){return H(r)<this.startOf(u)},l.isBefore=function(r,u){return this.endOf(u)<H(r)},l.$g=function(r,u,c){return $.u(r)?this[u]:this.set(c,r)},l.unix=function(){return Math.floor(this.valueOf()/1e3)},l.valueOf=function(){return this.$d.getTime()},l.startOf=function(r,u){var c=this,b=!!$.u(u)||u,p=$.p(r),I=function(q,G){var Z=$.w(c.$u?Date.UTC(c.$y,G,q):new Date(c.$y,G,q),c);return b?Z:Z.endOf(C)},F=function(q,G){return $.w(c.toDate()[q].apply(c.toDate("s"),(b?[0,0,0,0]:[23,59,59,999]).slice(G)),c)},N=this.$W,j=this.$M,U=this.$D,Q="set"+(this.$u?"UTC":"");switch(p){case T:return b?I(1,0):I(31,11);case M:return b?I(1,j):I(0,j+1);case A:var V=this.$locale().weekStart||0,ne=(N<V?N+7:N)-V;return I(b?U-ne:U+(6-ne),j);case C:case x:return F(Q+"Hours",0);case v:return F(Q+"Minutes",1);case B:return F(Q+"Seconds",2);case d:return F(Q+"Milliseconds",3);default:return this.clone()}},l.endOf=function(r){return this.startOf(r,!1)},l.$set=function(r,u){var c,b=$.p(r),p="set"+(this.$u?"UTC":""),I=(c={},c[C]=p+"Date",c[x]=p+"Date",c[M]=p+"Month",c[T]=p+"FullYear",c[v]=p+"Hours",c[B]=p+"Minutes",c[d]=p+"Seconds",c[m]=p+"Milliseconds",c)[b],F=b===C?this.$D+(u-this.$W):u;if(b===M||b===T){var N=this.clone().set(x,1);N.$d[I](F),N.init(),this.$d=N.set(x,Math.min(this.$D,N.daysInMonth())).$d}else I&&this.$d[I](F);return this.init(),this},l.set=function(r,u){return this.clone().$set(r,u)},l.get=function(r){return this[$.p(r)]()},l.add=function(r,u){var c,b=this;r=Number(r);var p=$.p(u),I=function(j){var U=H(b);return $.w(U.date(U.date()+Math.round(j*r)),b)};if(p===M)return this.set(M,this.$M+r);if(p===T)return this.set(T,this.$y+r);if(p===C)return I(1);if(p===A)return I(7);var F=(c={},c[B]=i,c[v]=E,c[d]=o,c)[p]||1,N=this.$d.getTime()+r*F;return $.w(N,this)},l.subtract=function(r,u){return this.add(-1*r,u)},l.format=function(r){var u=this,c=this.$locale();if(!this.isValid())return c.invalidDate||g;var b=r||"YYYY-MM-DDTHH:mm:ssZ",p=$.z(this),I=this.$H,F=this.$m,N=this.$M,j=c.weekdays,U=c.months,Q=c.meridiem,V=function(G,Z,ae,le){return G&&(G[Z]||G(u,b))||ae[Z].slice(0,le)},ne=function(G){return $.s(I%12||12,G,"0")},q=Q||function(G,Z,ae){var le=G<12?"AM":"PM";return ae?le.toLowerCase():le};return b.replace(P,function(G,Z){return Z||function(ae){switch(ae){case"YY":return String(u.$y).slice(-2);case"YYYY":return $.s(u.$y,4,"0");case"M":return N+1;case"MM":return $.s(N+1,2,"0");case"MMM":return V(c.monthsShort,N,U,3);case"MMMM":return V(U,N);case"D":return u.$D;case"DD":return $.s(u.$D,2,"0");case"d":return String(u.$W);case"dd":return V(c.weekdaysMin,u.$W,j,2);case"ddd":return V(c.weekdaysShort,u.$W,j,3);case"dddd":return j[u.$W];case"H":return String(I);case"HH":return $.s(I,2,"0");case"h":return ne(1);case"hh":return ne(2);case"a":return q(I,F,!0);case"A":return q(I,F,!1);case"m":return String(F);case"mm":return $.s(F,2,"0");case"s":return String(u.$s);case"ss":return $.s(u.$s,2,"0");case"SSS":return $.s(u.$ms,3,"0");case"Z":return p}return null}(G)||p.replace(":","")})},l.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},l.diff=function(r,u,c){var b,p=this,I=$.p(u),F=H(r),N=(F.utcOffset()-this.utcOffset())*i,j=this-F,U=function(){return $.m(p,F)};switch(I){case T:b=U()/12;break;case M:b=U();break;case L:b=U()/3;break;case A:b=(j-N)/6048e5;break;case C:b=(j-N)/864e5;break;case v:b=j/E;break;case B:b=j/i;break;case d:b=j/o;break;default:b=j}return c?b:$.a(b)},l.daysInMonth=function(){return this.endOf(M).$D},l.$locale=function(){return s[this.$L]},l.locale=function(r,u){if(!r)return this.$L;var c=this.clone(),b=W(r,u,!0);return b&&(c.$L=b),c},l.clone=function(){return $.w(this.$d,this)},l.toDate=function(){return new Date(this.valueOf())},l.toJSON=function(){return this.isValid()?this.toISOString():null},l.toISOString=function(){return this.$d.toISOString()},l.toString=function(){return this.$d.toUTCString()},f}(),w=J.prototype;return H.prototype=w,[["$ms",m],["$s",d],["$m",B],["$H",v],["$W",C],["$M",M],["$y",T],["$D",x]].forEach(function(f){w[f[1]]=function(l){return this.$g(l,f[0],f[1])}}),H.extend=function(f,l){return f.$i||(f(l,J,H),f.$i=!0),H},H.locale=W,H.isDayjs=O,H.unix=function(f){return H(1e3*f)},H.en=s[y],H.Ls=s,H.p={},H})})(ge);var ve=ge.exports;const ce=me(ve),D={Annual:"ANNUAL",Every30Days:"EVERY_30_DAYS"},ee={Public:"public",CustomerTag:"customerTag",ShopifyPlan:"shopifyPlan",Customer:"customer",Hidden:"hidden"},k={AmountPerInterval:"{{ amount }} per {{ interval }}",Back:"Back",Cancel:"Cancel",CancelConfirmation:"Are you sure you want to cancel your subscription?",CancelPlan:"Cancel plan",ChangePlan:"Change plan",CurrentPlan:"Current plan",CustomPlans:"Custom plans",CustomPlansDescription:"Plans tailored to your specific needs",DiscountAmount:"{{ amount }} discount",DiscountAmountExpired:"{{ amount }} discount expired",FreeTrialLength:"{{ trialDays }}-day free trial",Features:"Features",Month:"month",MonthShort:"mo",Monthly:"Monthly",NextBillingDate:"Next billing date",NotSubscribed:"You're not subscribed to a plan yet.",Year:"year",YearShort:"yr",Yearly:"Yearly",MostPopular:"Most popular",Per:"/",Plans:"Plans",Price:"Price",SelectPlan:"Select plan",SubscribeSuccessTitle:"Subscription successful",SubscribeSuccessBody:"Thanks for subscribing to our app!",Subscription:"Subscription",SubscriptionCancelled:"Subscription cancelled",UsageCharges:"Usage charges"},be=e.createContext(),pe=()=>{const n=e.useContext(be);if(n===void 0)throw new Error("useMantle must be used within a MantleProvider");return n},ke=(n="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:n,notation:"standard"}),R=(n,a="USD",o=!0)=>{let i=ke(a).format(n);return o&&(i=i.replace(/\.00$/,"")),i},Ce=(n=D.Every30Days)=>{switch(n){case D.Annual:return"year";case D.Every30Days:default:return"month"}},xe=(n=D.Every30Days)=>{switch(n){case D.Annual:return"yr";case D.Every30Days:default:return"mo"}},te=({interval:n=D.Every30Days,useShortFormPlanIntervals:a=!0})=>a?xe(n):Ce(n),se=({plan:n,customFieldKey:a="recommended"})=>{var o;return!!((o=n.customFields)!=null&&o[a])},ue=({plan:n,customFieldKey:a="buttonLabel"})=>{var o;return((o=n.customFields)==null?void 0:o[a])||k.SelectPlan},he=({plan:n})=>{var a;return((a=n.discounts)==null?void 0:a.length)>0?n.discounts.reduce((o,i)=>o.discountedAmount<i.discountedAmount?o:i):void 0},Be=(n=4)=>n%4===0?{xs:6,sm:6,md:2,lg:3,xl:3}:n%3===0?{xs:6,sm:6,md:2,lg:4,xl:4}:n%2===0?{xs:6,sm:6,md:3,lg:6,xl:6}:n===1?{xs:6,sm:6,md:6,lg:12,xl:12}:{xs:6,sm:6,md:2,lg:4,xl:4},Pe=(n=4)=>n%4===0?4:n%3===0?3:n%2===0?2:n===1?1:4,$e=({orientation:n="horizontal",onShowPlans:a,onCancelPlan:o,onPlanCancelled:i=()=>{},cancelSubscription:E=async()=>{},i18n:m,subscription:d,refetch:B=async()=>{},apps:v=[]})=>e.createElement(t.Banner,{title:"Bundle and save!",tone:"success"},e.createElement(t.BlockStack,{gap:"400"},e.createElement(t.Text,null,"Save money on your subscription when you install these great apps."),e.createElement(t.BlockStack,{gap:"300"},v.map((C,A)=>e.createElement(t.BlockStack,{gap:"300"},e.createElement(t.InlineStack,{gap:"200",align:"space-between",blockAlign:"center"},e.createElement(t.InlineStack,{gap:"300"},e.createElement(t.Thumbnail,{source:C.iconUrl,alt:C.name,size:"small"}),e.createElement(t.BlockStack,null,e.createElement(t.Text,{variant:"headingSm"},C.name),e.createElement(t.Text,null,C.description))),e.createElement(t.InlineStack,{gap:"400"},e.createElement(t.Text,{tone:"subdued"},"20% off"),e.createElement(t.BlockStack,null,e.createElement(t.Button,null,m.Install)))),A<v.length-1&&e.createElement(t.Divider,null))))));var X=function(a){return e.createElement("svg",Object.assign({viewBox:"0 0 20 20"},a),e.createElement("path",{fillRule:"evenodd",d:"M15.78 5.97a.75.75 0 0 1 0 1.06l-6.5 6.5a.75.75 0 0 1-1.06 0l-3.25-3.25a.75.75 0 1 1 1.06-1.06l2.72 2.72 5.97-5.97a.75.75 0 0 1 1.06 0Z"}))};X.displayName="CheckIcon";var ie=function(a){return e.createElement("svg",Object.assign({viewBox:"0 0 20 20"},a),e.createElement("path",{d:"M10.75 6.75a.75.75 0 0 0-1.5 0v2.5h-2.5a.75.75 0 0 0 0 1.5h2.5v2.5a.75.75 0 0 0 1.5 0v-2.5h2.5a.75.75 0 0 0 0-1.5h-2.5v-2.5Z"}))};ie.displayName="PlusIcon";const De=({plan:n,t:a,translatePlanName:o,planNameTextVariant:i,planDescriptionTextVariant:E})=>e.createElement(t.BlockStack,{gap:"100"},e.createElement(t.Text,{variant:i,alignment:"center"},o?a(n.name):n.name),n.description&&e.createElement(t.Text,{variant:E,tone:"subdued",alignment:"center"},a(n.description))),Me=({plan:n,discount:a,t:o,priceTextVariant:i,currency:E,useShortFormPlanIntervals:m=!0})=>e.createElement(t.BlockStack,{gap:"100"},!!a&&e.createElement(t.InlineStack,{align:"center",blockAlign:"center",gap:"200"},e.createElement(t.Text,{variant:i},R(a.discountedAmount,E,!0)),e.createElement(t.Text,{variant:i,tone:"subdued",fontWeight:"medium",textDecorationLine:"line-through"},R(n.amount,E,!0)),e.createElement(t.Text,{variant:"bodyLg",tone:"subdued"},o(k.Per)," ",o(te({interval:n.interval,useShortFormPlanIntervals:m})))),!a&&e.createElement(t.InlineStack,{align:"center",blockAlign:"center",gap:"200"},e.createElement(t.Text,{alignment:"center",variant:i},R(n.amount,E,!0)),e.createElement(t.Text,{alignment:"center",variant:"bodyLg",tone:"subdued"},o(k.Per)," ",o(te({interval:n.interval,useShortFormPlanIntervals:m})))),n.usageCharges.length>0&&e.createElement(t.BlockStack,null,n.usageCharges.map((d,B)=>e.createElement(t.InlineStack,{key:`plan-usageCharge-${B}`,align:"center",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:ie,tone:"subdued"})),e.createElement(t.Text,{variant:"bodyLg"},o(d.terms)))))),we=({plan:n,t:a,trialDaysAsFeature:o=!1})=>e.createElement(t.BlockStack,{gap:"300"},o&&n.trialDays&&n.trialDays>0?e.createElement(t.InlineStack,{align:"center",blockAlign:"center",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:X,tone:"subdued"})),e.createElement(t.Text,null,a(k.FreeTrialLength).replace("{{ trialDays }}",n.trialDays))):null,n.featuresOrder.map((i,E)=>{const m=n.features[i];if(m.type!=="boolean"||m.value===!0)return e.createElement(t.InlineStack,{key:`plan-feature-${E}`,align:"center",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:X,tone:"subdued"})),m.type==="boolean"?e.createElement(t.Text,null,a(m.name)):e.createElement(t.Text,null,m.value," ",a(m.name)))})),fe=({plan:n,discount:a,buttonLabel:o,onSelectPlan:i,useShortFormPlanIntervals:E=!0,trialDaysAsFeature:m=!1,expanded:d=!1,isActivePlan:B=!1,isRecommendedPlan:v=!1,isCustomPlan:C=!1,showRecommendedPlanBadge:A=!0,t:M,translatePlanName:L=!0,planNameTextVariant:T="headingMd",planDescriptionTextVariant:x="bodyLg",priceTextVariant:g="heading3xl",currency:h})=>{const[P,Y]=e.useState(!1),S=M||(y=>y),_=async({plan:y,discount:s})=>{i?(Y(!0),await i({plan:y,discount:s})!==!0&&Y(!1)):console.log("No onSelectPlan callback provided")};return e.createElement(t.Box,{position:"relative",minHeight:"100%"},e.createElement(t.Box,{paddingBlock:d||v?void 0:"800",minHeight:"100%"},e.createElement(t.Box,{background:v||C?"bg-surface":"bg-surface-secondary",borderStyle:"solid",borderColor:"border",borderWidth:"025",paddingBlock:d||v?"1600":"800",paddingInline:"400",borderRadius:"200",minHeight:"calc(100% - calc(var(--p-space-800) * 2))"},e.createElement(t.BlockStack,{gap:"800"},e.createElement(t.BlockStack,{gap:"400"},e.createElement(De,{plan:n,t:S,translatePlanName:L,planNameTextVariant:T,planDescriptionTextVariant:x}),e.createElement(Me,{plan:n,discount:a,useShortFormPlanIntervals:E,t:S,priceTextVariant:g,currency:h})),e.createElement(t.Button,{size:"large",variant:v?"primary":"secondary",onClick:async()=>{await _({plan:n,discount:a})},disabled:B,loading:P},S(o||k.SelectPlan)),e.createElement(we,{plan:n,t:S,trialDaysAsFeature:m}),v&&A&&e.createElement(t.InlineStack,{align:"center",gap:"100"},e.createElement(t.Badge,{tone:"success"},S(k.MostPopular)))))))},K={Highlighted:"highlighted",Horizontal:"horizontal",Vertical:"vertical"},re=({plans:n,customer:a,onSelectPlan:o,planInterval:i,cardType:E=K.Horizontal,trialDaysAsFeature:m=!0,useShortFormPlanIntervals:d=!0,keyForRecommended:B="recommended",keyForCustomButtonLabel:v="buttonLabel",showRecommendedPlanBadge:C=!0,applyDiscount:A=!0,t:M,translatePlanName:L=!0,currency:T})=>{var _;const x=(_=a==null?void 0:a.subscription)!=null&&_.active?a.subscription:void 0,g=x==null?void 0:x.plan,h=i?n.filter(y=>y.interval===i):n,P=E===K.Vertical?1:Pe(h.length),Y=Be(P),S=M||(y=>y);return e.createElement(t.Grid,{columns:P},h.map(y=>{const s=A?he({plan:y}):void 0,z=(g==null?void 0:g.id)===y.id&&!(x!=null&&x.cancelOn),O=T||y.currency;return e.createElement(t.Grid.Cell,{columnSpan:Y,key:y.id},E===K.Highlighted&&e.createElement(fe,{key:`HighlightedPlanCard-${y.id}`,plan:y,discount:s,onSelectPlan:o,isActivePlan:z,trialDaysAsFeature:m,useShortFormPlanIntervals:d,isCustomPlan:y.availability!==ee.Public,isRecommendedPlan:se({plan:y,customFieldKey:B}),buttonLabel:ue({plan:y,customFieldKey:v}),showRecommendedPlanBadge:C,t:S,translatePlanName:L,currency:O}),E===K.Horizontal&&e.createElement(Ee,{key:`HorizontalPlanCard-${y.id}`,plan:y,discount:s,onSelectPlan:o,isActivePlan:z,trialDaysAsFeature:m,useShortFormPlanIntervals:d,isRecommendedPlan:se({plan:y,customFieldKey:B}),buttonLabel:ue({plan:y,customFieldKey:v}),showRecommendedPlanBadge:C,t:S,translatePlanName:L,currency:O}))}))},Te=({customer:n,plans:a,onSubscribe:o,backUrl:i="",showRecommendedBadge:E=!0,customFieldCta:m,customFieldPlanRecommended:d="Recommended",showPlanIntervalToggle:B=!0,showTrialDaysAsFeature:v=!0,useShortFormPlanIntervals:C,pageWidth:A="default",showCustomPlans:M=!0})=>{const L=n==null?void 0:n.subscription,T=new URLSearchParams(window.location.search),x=a.some(s=>s.interval===D.Annual)&&a.some(s=>s.interval===D.Every30Days),g=a.find(s=>s.id===(L==null?void 0:L.plan.id)),[h,P]=e.useState(g?g.interval:x?D.Annual:D.Every30Days),Y=a.filter(s=>s.availability===ee.Public),S=M?a.filter(s=>s.availability!==ee.Public):[],[_,y]=e.useState(T.get("subscribed")==="true");return e.createElement(t.Page,{title:k.Plans,backAction:i?{content:k.Back,url:i}:void 0,secondaryActions:B&&x?e.createElement(t.ButtonGroup,{variant:"segmented"},e.createElement(t.Button,{pressed:h===D.Every30Days,onClick:()=>P(D.Every30Days)},k.Monthly),e.createElement(t.Button,{pressed:h===D.Annual,onClick:()=>P(D.Annual)},k.Yearly)):void 0,fullWidth:A==="full",narrowWidth:A==="narrow"},e.createElement(t.Layout,null,e.createElement(t.Layout.Section,null,e.createElement(t.BlockStack,{gap:"1000"},_&&e.createElement(t.Banner,{tone:"success",title:k.SubscribeSuccessTitle,onDismiss:()=>{y(!1),window.history.replaceState({},document.title,window.location.pathname)}},k.SubscribeSuccessBody),e.createElement(re,{plans:Y,onSelectPlan:o,planInterval:h,cardType:K.Horizontal,keyForRecommended:d,keyForCustomButtonLabel:m,trialDaysAsFeature:v,useShortFormPlanIntervals:C,showRecommendedPlanBadge:E}),(S==null?void 0:S.length)>0&&e.createElement(t.Divider,{borderColor:"border"}),(S==null?void 0:S.length)>0&&e.createElement(t.BlockStack,{gap:"300"},e.createElement(t.Box,{paddingInline:{xs:400,sm:0}},e.createElement(t.Text,{variant:"headingMd"},k.CustomPlans)),e.createElement(re,{plans:S,onSelectPlan:o,planInterval:h,cardType:K.Horizontal,keyForRecommended:d,keyForCustomButtonLabel:m,trialDaysAsFeature:v,useShortFormPlanIntervals:C,showRecommendedPlanBadge:E}))))))},Ae=({plan:n,t:a,translatePlanName:o,isRecommendedPlan:i=!1,planNameTextVariant:E,planDescriptionTextVariant:m,showRecommendedPlanBadge:d})=>e.createElement(t.BlockStack,{gap:"100"},e.createElement(t.InlineStack,{align:"space-between",gap:"100"},e.createElement(t.Text,{variant:E},o?a(n.name):n.name),i&&d&&e.createElement(t.Badge,{tone:"success"},a(k.MostPopular))),n.description&&e.createElement(t.Text,{variant:m,tone:"subdued"},a(n.description))),Le=({plan:n,discount:a,t:o,currency:i,useShortFormPlanIntervals:E=!0,priceTextVariant:m})=>e.createElement(t.BlockStack,null,!!a&&e.createElement(t.InlineStack,{blockAlign:"center",gap:"200"},e.createElement(t.Text,{variant:m},R(a.discountedAmount,i)),e.createElement(t.Text,{variant:m,tone:"subdued",fontWeight:"medium",textDecorationLine:"line-through"},n.amount),e.createElement(t.Text,{variant:"bodyLg",tone:"subdued"},o(k.Per)," ",o(te({interval:n.interval,useShortFormPlanIntervals:E})))),!a&&e.createElement(t.InlineStack,{blockAlign:"center",gap:"200"},e.createElement(t.Text,{alignment:"center",variant:m},R(n.amount,i)),e.createElement(t.Text,{alignment:"center",variant:"bodyLg",tone:"subdued"},o(k.Per)," ",o(te({interval:n.interval,useShortFormPlanIntervals:E})))),n.usageCharges&&n.usageCharges.length>0&&e.createElement(t.BlockStack,null,n.usageCharges.map((d,B)=>e.createElement(t.InlineStack,{key:`plan-usageCharge-${B}`,align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:ie,tone:"subdued"})),e.createElement(t.Text,{variant:"bodyLg"},o(d.terms)))))),Ie=({plan:n,t:a,trialDaysAsFeature:o=!1})=>e.createElement(t.BlockStack,{gap:"100"},o&&n.trialDays&&n.trialDays>0?e.createElement(t.InlineStack,{align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:X,tone:"subdued"})),e.createElement(t.Text,null,a(k.FreeTrialLength).replace("{{ trialDays }}",n.trialDays))):null,n.featuresOrder.map((i,E)=>{const m=n.features[i];if(m.type!=="boolean"||m.value===!0)return e.createElement(t.InlineStack,{key:`plan-feature-${E}`,align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:X,tone:"subdued"})),m.type==="boolean"?e.createElement(t.Text,null,a(m.name)):e.createElement(t.Text,null,m.value," ",a(m.name)))})),Ee=({plan:n,discount:a,buttonLabel:o,onSelectPlan:i,useShortFormPlanIntervals:E=!0,trialDaysAsFeature:m=!1,isRecommendedPlan:d=!1,isActivePlan:B=!1,t:v,translatePlanName:C=!0,showRecommendedPlanBadge:A=!0,planNameTextVariant:M="bodyLg",planDescriptionTextVariant:L="bodyMd",priceTextVariant:T="headingXl",currency:x})=>{const[g,h]=e.useState(!1),P=v||(S=>S),Y=async({plan:S,discount:_})=>{i?(h(!0),await i({plan:S,discount:_})!==!0&&h(!1)):console.log("No onSelectPlan callback provided")};return e.createElement(t.Card,null,e.createElement(t.BlockStack,{gap:"400"},e.createElement(Ae,{plan:n,isRecommendedPlan:d,showRecommendedPlanBadge:A,t:P,translatePlanName:C,planNameTextVariant:M,planDescriptionTextVariant:L}),e.createElement(Le,{plan:n,discount:a,useShortFormPlanIntervals:E,t:P,priceTextVariant:T,currency:x}),e.createElement(t.Button,{size:"large",variant:d?"primary":"secondary",onClick:async()=>{await Y({plan:n,discount:a})},disabled:B,loading:g},P(B?k.CurrentPlan:o||k.SelectPlan)),e.createElement(Ie,{plan:n,trialDaysAsFeature:m,t:P})))},Ye=({customer:n,plans:a,onSubscribe:o,backUrl:i="",showRecommendedBadge:E=!0,customFieldCta:m=null,customFieldPlanRecommended:d="Recommended",showPlanIntervalToggle:B=!0,showTrialDaysAsFeature:v=!0,useShortFormPlanIntervals:C=!0,pageWidth:A="default",showCustomPlans:M=!0})=>{const L=n==null?void 0:n.subscription,T=new URLSearchParams(window.location.search),x=a.some(s=>s.interval===D.Annual)&&a.some(s=>s.interval===D.Every30Days),g=a.find(s=>s.id===(L==null?void 0:L.plan.id)),[h,P]=e.useState(g?g.interval:x?D.Annual:D.Every30Days),Y=a.filter(s=>s.availability===ee.Public),S=M?a.filter(s=>s.availability!==ee.Public):[],[_,y]=e.useState(T.get("subscribed")==="true");return e.createElement(t.Page,{title:k.Plans,backAction:i&&i!==""?{content:k.Back,url:i}:void 0,secondaryActions:B&&x?e.createElement(t.ButtonGroup,{variant:"segmented"},e.createElement(t.Button,{pressed:h===D.Every30Days,onClick:()=>P(D.Every30Days)},k.Monthly),e.createElement(t.Button,{pressed:h===D.Annual,onClick:()=>P(D.Annual)},k.Yearly)):void 0,fullWidth:A==="full",narrowWidth:A==="narrow"},e.createElement(t.Box,{paddingBlockEnd:"800"},e.createElement(t.Layout,null,e.createElement(t.Layout.Section,null,e.createElement(t.BlockStack,{gap:"1000"},_&&e.createElement(t.Banner,{tone:"success",title:k.SubscribeSuccessTitle,onDismiss:()=>{y(!1),window.history.replaceState({},document.title,window.location.pathname)}},k.SubscribeSuccessBody),e.createElement(re,{plans:Y,onSelectPlan:o,planInterval:h,cardType:K.Highlighted,keyForRecommended:d,keyForCustomButtonLabel:m,trialDaysAsFeature:v,useShortFormPlanIntervals:C,showRecommendedPlanBadge:E}),(S==null?void 0:S.length)>0&&e.createElement(t.Divider,{borderColor:"border"}),(S==null?void 0:S.length)>0&&e.createElement(t.BlockStack,{gap:"300"},e.createElement(t.Box,{paddingInline:{xs:400,sm:0}},e.createElement(t.Text,{variant:"headingMd"},k.CustomPlans)),e.createElement(re,{plans:S,onSelectPlan:o,planInterval:h,cardType:K.Highlighted,keyForRecommended:d,keyForCustomButtonLabel:m,trialDaysAsFeature:v,useShortFormPlanIntervals:C,showRecommendedPlanBadge:E})))))))},ye=({plan:n,discount:a,buttonLabel:o,onSelectPlan:i,useShortFormPlanIntervals:E=!0,trialDaysAsFeature:m=!1,isRecommendedPlan:d=!1,isActivePlan:B=!1,t:v=_t,translatePlanName:C=!0,showRecommendedPlanBadge:A=!0,planNameTextVariant:M="bodyLg",planDescriptionTextVariant:L="bodyMd",priceTextVariant:T="headingXl",currency:x})=>{const[g,h]=e.useState(!1),P=async({plan:s,discount:z})=>{i?(h(!0),await i({plan:s,discount:z})!==!0&&h(!1)):console.log("No onSelectPlan callback provided")},Y=({plan:s})=>e.createElement(t.BlockStack,null,e.createElement(t.Text,{variant:M},C?v(s.name):s.name),s.description&&e.createElement(t.Text,{variant:L,tone:"subdued"},v(s.description))),S=({plan:s})=>e.createElement(t.BlockStack,{gap:"200"},e.createElement(t.Text,{fontWeight:"medium"},v(k.Features)),e.createElement(t.BlockStack,{gap:"100"},m&&s.trialDays&&s.trialDays>0?e.createElement(t.InlineStack,{align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:X,tone:"positive"})),e.createElement(t.Text,{tone:"subdued"},v(k.FreeTrialLength.replace("{{ trialDays }}",s.trialDays)))):null,s.featuresOrder.map((z,O)=>{const W=s.features[z];if(W.type!=="boolean"||W.value===!0)return e.createElement(t.InlineStack,{key:`plan-feature-${O}`,align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:X,tone:"positive"})),W.type==="boolean"?e.createElement(t.Text,{tone:"subdued"},W.name):e.createElement(t.Text,{tone:"subdued"},W.value," ",W.name))}))),_=({plan:s,discount:z})=>e.createElement(t.BlockStack,{gap:"100"},z?e.createElement(t.InlineStack,{blockAlign:"center",gap:"200"},e.createElement(t.Text,{variant:T},R(z.discountedAmount,x)),e.createElement(t.Text,{variant:T,tone:"subdued",fontWeight:"medium",textDecorationLine:"line-through"},s.amount),e.createElement(t.Text,{variant:"bodyLg",tone:"subdued"},k.Per," ",te({interval:s.interval,useShortFormPlanIntervals:E}))):e.createElement(t.InlineStack,{blockAlign:"center",gap:"200"},e.createElement(t.Text,{alignment:"center",variant:T},R(s.amount,x)),e.createElement(t.Text,{alignment:"center",variant:"bodyLg",tone:"subdued"},k.Per," ",te({interval:s.interval,useShortFormPlanIntervals:E}))),s.usageCharges.length>0&&e.createElement(t.BlockStack,null,s.usageCharges.map((O,W)=>e.createElement(t.InlineStack,{key:`plan-usageCharge-${W}`,align:"start",gap:"100"},e.createElement(t.Box,null,e.createElement(t.Icon,{source:ie,tone:"positive"})),e.createElement(t.Text,{variant:"bodyLg"},O.terms))))),y=({plan:s,discount:z})=>e.createElement(t.InlineStack,{blockAlign:"center",gap:"400"},e.createElement(t.Button,{size:"large",variant:d?"primary":"secondary",onClick:async()=>{await P({plan:s,discount:z})},disabled:B,loading:g},v(B?k.CurrentPlan:o||k.SelectPlan)),d&&A&&e.createElement(t.Badge,{tone:"success"},v(k.MostPopular)));return e.createElement(t.Card,null,e.createElement(t.Grid,null,e.createElement(t.Grid.Cell,{columnSpan:{xs:6,sm:6,md:3,lg:6,xl:6}},e.createElement(t.BlockStack,{gap:"300"},Y({plan:n}),_({plan:n,discount:a}),e.createElement(t.Box,null,y({plan:n,discount:a})))),e.createElement(t.Grid.Cell,{columnSpan:{xs:6,sm:6,md:3,lg:6,xl:6}},S({plan:n}))))},He=({plans:n,customer:a,onSubscribe:o,backUrl:i="",keyForRecommended:E="recommended",keyForCustomButtonLabel:m="buttonLabel",showPlanIntervalToggle:d=!1,trialDaysAsFeature:B=!0,useShortFormPlanIntervals:v=!0,pageWidth:C="default",showCustomPlans:A=!0,showRecommendedPlanBadge:M=!0,applyDiscount:L=!0,t:T,translatePlanName:x=!0,currency:g})=>{var J;const h=new URLSearchParams(window.location.search),P=n.some(w=>w.interval===D.Annual)&&n.some(w=>w.interval===D.Every30Days),Y=(J=a==null?void 0:a.subscription)!=null&&J.active?a.subscription:void 0,S=Y==null?void 0:Y.plan,[_,y]=e.useState(S?S.interval:P?D.Annual:D.Every30Days),s=n.filter(w=>w.availability!=="customerTag"&&w.availability!=="customer"),z=d&&P?s.filter(w=>w.interval===_):s,O=A?n.filter(w=>w.availability==="customerTag"||w.availability==="customer"):[],[W,H]=e.useState(h.get("subscribed")==="true"),$=T||(w=>w);return e.createElement(t.Page,{title:k.Plans,backAction:i!==""?{content:k.Back,url:i}:void 0,secondaryActions:d&&P?e.createElement(t.ButtonGroup,{variant:"segmented"},e.createElement(t.Button,{pressed:_===D.Every30Days,onClick:()=>y(D.Every30Days)},k.Monthly),e.createElement(t.Button,{pressed:_===D.Annual,onClick:()=>y(D.Annual)},k.Year)):void 0,fullWidth:C==="full",narrowWidth:C==="narrow"},e.createElement(t.Layout,null,e.createElement(t.Layout.Section,null,e.createElement(t.BlockStack,{gap:"400"},W&&e.createElement(t.Banner,{tone:"success",title:k.SubscribeSuccessTitle,onDismiss:()=>{H(!1),window.history.replaceState({},document.title,window.location.pathname)}},k.SubscribeSuccessBody),z.map((w,f)=>{const l=L?he({plan:w}):void 0,r=(S==null?void 0:S.id)===w.id&&!(Y!=null&&Y.cancelOn);return e.createElement(ye,{key:`plan-${f}`,plan:w,discount:l,onSelectPlan:o,isActivePlan:r,trialDaysAsFeature:B,useShortFormPlanIntervals:v,isCustomPlan:w.availability!==ee.Public,isRecommendedPlan:se({plan:w,customFieldKey:E}),buttonLabel:ue({plan:w,customFieldKey:m}),showRecommendedPlanBadge:M,t:$,translatePlanName:x,currency:g||w.currency})}),(O==null?void 0:O.length)>0&&e.createElement(t.Divider,{borderColor:"border"}),(O==null?void 0:O.length)>0&&e.createElement(t.BlockStack,{gap:"300"},e.createElement(t.Box,{paddingInline:{xs:400,sm:0}},e.createElement(t.Text,{variant:"headingMd"},k.CustomPlans)),e.createElement(t.Grid,null,O.map((w,f)=>{var r;const l=((r=w.discounts)==null?void 0:r.length)>0?w.discounts.reduce((u,c)=>u.discountedAmount<c.discountedAmount?u:c):null;return e.createElement(t.Grid.Cell,{key:`custom-plan-${f}`,columnSpan:columnSpan()},e.createElement(t.Card,null,e.createElement(t.BlockStack,{gap:"400"},titleComponent({plan:w,discount:l}),pricingComponent({plan:w,discount:l}),ctaComponent({plan:w,discount:l}),featuresComponent({plan:w,discount:l}))))})))))))};var Se={exports:{}};(function(n,a){(function(o,i){n.exports=i()})(de,function(){var o={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(i,E,m){var d=E.prototype,B=d.format;m.en.formats=o,d.format=function(v){v===void 0&&(v="YYYY-MM-DDTHH:mm:ssZ");var C=this.$locale().formats,A=function(M,L){return M.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(T,x,g){var h=g&&g.toUpperCase();return x||L[g]||o[g]||L[h].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(P,Y,S){return Y||S.slice(1)})})}(v,C===void 0?{}:C);return B.call(this,A)}}})})(Se);var Oe=Se.exports;const Fe=me(Oe);ce.extend(Fe);const oe=({orientation:n="horizontal",onShowPlans:a,onCancelPlan:o,onPlanCancelled:i=()=>{},cancelSubscription:E=async()=>{},i18n:m,subscription:d,refetch:B=async()=>{},t:v,translatePlanName:C=!0,currency:A})=>{var W;const[M,L]=e.useState(!1),[T,x]=e.useState(!1),g=v||(H=>H),h={...k,...m||{}};if(!d)return e.createElement(t.Card,null,e.createElement(t.BlockStack,{gap:"200"},e.createElement(t.Text,{variant:"headingMd"},g(h.Subscription)),e.createElement(t.Text,null,g(h.NotSubscribed)),e.createElement(t.InlineStack,{align:"end"},e.createElement(t.ButtonGroup,null,e.createElement(t.Button,{variant:"primary",onClick:a,accessibilityLabel:g(h.ChangePlan)},g(h.SelectPlan))))));const{plan:P}=d;A=A||P.currency;const Y=R(d.total,A),S=g(P.interval===D.Annual?h.Year:h.Month),_=n==="horizontal"?t.InlineGrid:t.BlockStack,y=(W=d==null?void 0:d.appliedDiscount)==null?void 0:W.discount,s=y?y.percentage?`${y.percentage}%`:R(y.amount,A):null,z=y&&d.appliedDiscount.discountEndsAt&&ce().isAfter(ce(d.appliedDiscount.discountEndsAt)),O=P.usageCharges.length>0?{xs:1,md:3}:{xs:1,md:2};return e.createElement(t.Card,null,e.createElement(t.BlockStack,{gap:"200"},e.createElement(t.Text,{variant:"headingMd"},g(h.Subscription)),e.createElement(t.BlockStack,{gap:"400"},e.createElement(_,{columns:O,gap:"300"},e.createElement(t.BlockStack,null,e.createElement(t.Text,null,g(h.CurrentPlan)),e.createElement(t.Text,{tone:"subdued"},C?g(P.name):P.name),d.cancelOn&&e.createElement(t.Text,{tone:"subdued"},g("Canceled, active until {{ date }}").replace("{{ date }}",ce(d.cancelOn).format("LL")))),e.createElement(t.BlockStack,null,e.createElement(t.Text,null,g(h.Price)),e.createElement(t.BlockStack,null,e.createElement(t.Text,{tone:"subdued"},g(h.AmountPerInterval).replace("{{ amount }}",Y).replace("{{ interval }}",S)),y&&!z&&e.createElement(t.Text,{tone:"success"},g(h.DiscountAmount).replace("{{ amount }}",s)),y&&z&&e.createElement(t.Text,{tone:"subdued",textDecorationLine:"line-through"},g(h.DiscountAmountExpired).replace("{{ amount }}",s)))),P.usageCharges.length>0&&e.createElement(t.BlockStack,null,e.createElement(t.Text,null,g(h.UsageCharges||"Usage charges")),P.usageCharges.map((H,$)=>e.createElement(t.Text,{key:`usage-charge-${$}`,tone:"subdued"},g(H.terms))))),e.createElement(t.InlineStack,{align:"end"},e.createElement(t.ButtonGroup,null,e.createElement(t.Button,{onClick:()=>{o?o():L(!0)},accessibilityLabel:g(h.CancelPlan),tone:"critical",disabled:!!d.cancelOn},g(h.CancelPlan)),e.createElement(t.Button,{variant:"primary",onClick:a,accessibilityLabel:g(h.ChangePlan)},g(h.ChangePlan)))))),M&&e.createElement(t.Modal,{open:!0,onClose:()=>L(!1),title:g(h.CancelPlan),primaryAction:{content:g(h.CancelPlan),destructive:!0,loading:T,disabled:T,onAction:async()=>{x(!0),await E(),await B(),x(!1),L(!1),i()}},secondaryActions:[{content:g(h.Back),disabled:T,onAction:()=>L(!1)}]},e.createElement(t.Modal.Section,null,g(h.CancelConfirmation))))},_e=({backUrl:n="",pageWidth:a="narrow"})=>{const{cancelSubscription:o,i18n:i,subscription:E,refetch:m}=pe(),d=()=>{console.log("Show plans. Navigate to the plans page, open a modal, etc.")};return e.createElement(t.Page,{title:i.Subscription,backAction:n?{content:i.Back,url:n}:void 0,fullWidth:a==="full",narrowWidth:a==="narrow"},e.createElement(t.BlockStack,{gap:"400"},e.createElement(oe,{onShowPlans:d,cancelSubscription:o,i18n:i,subscription:E,refetch:m}),e.createElement(t.Layout,null,e.createElement(t.Layout.Section,null,e.createElement(oe,{onShowPlans:d,cancelSubscription:o,i18n:i,subscription:E,refetch:m})),e.createElement(t.Layout.Section,{variant:"oneThird"},e.createElement(oe,{onShowPlans:d,cancelSubscription:o,i18n:i,subscription:E,refetch:m,orientation:"vertical"})))))};exports.BundleCard=$e;exports.HighlightedPlanCard=fe;exports.HighlightedPlanCards=Ye;exports.HorizontalPlanCard=Ee;exports.HorizontalPlanCards=Te;exports.PlanCardStack=re;exports.PlanCardType=K;exports.SubscriptionSummaryCard=oe;exports.SubscriptionSummaryPage=_e;exports.VerticalPlanCard=ye;exports.VerticalPlanCards=He;
